
// ZLabelPreviewSaveDlg.cpp : 구현 파일
//

#include "stdafx.h"
#include "ZLabelPreviewSave.h"
#include "ZLabelPreviewSaveDlg.h"
#include "afxdialogex.h"
#include "ConnectSocket.h"

#include "Define.h"
#include <intsafe.h> //HRESULT

#ifdef _DEBUG
#define new DEBUG_NEW
#endif

WCHAR* TEST_ZPL[] = { 
//////////////////////////////////////////1~12(T3LCY43G TB)
//1
L"~DGHALOGEN_PKT,01280,020,,:3FgSFE,3FQFE0g02,::3FJFE07FIFE0g02,3FJFC03FIFE0g02,3FJFC01FIFE0g02,3FJF800FIFE0g02,3FJF8007FC7E0g02,3FJF8003E01E0g02,3FJF8003800E0S06C0J02,3FJF80K0E3E018DF0F0J06C0J02,3FJF80K0E3E018DF1F0J060K02,3FJF80K0E367D8D8187DFDF6DF79DE2,3FJF80020H0E3E7DFDF187DADF6D14BD22,3FJFC0060H0E3E6DFDF186DADB6D14B1E2,3FJFC00E0H0E366D8C3186DADB6DF4B1E2,3FJFC00E001E367D8DF1F7DADF6D14BD02,3FJFE01F001E367D8DF0F7DADF6D149DE2,3FJFE01F003E0Q0180L02,3FKF01F007E0Q0180L02,3FKF83E00FE0Q0180L02,3FKF83E01FE0g02,3FKFC1E03FE0g02,3FKFE1C07FE0g02,3FLF801FFE330180K07C0M02,3FMF8FHFE330180K07C0M02,3FQFE337D80K060N02,3800780300FHFE3F7DBEF9F7C61DF7C0I02,38006002007FFE3F0DBEF916C7DD1440I02,380040H03C3FFE337DB6D9F6C7D9F7C0I02,38FF83FC7E3FFE337DB6D906C619040J02,38E007F8FF1FFE336DBEF906C619040J02,38E007F87F1FFE337DBEF9F6C619F7C0I02,38FFC3FC7E3FFE0L080R02,380040H03C3FFE0K0F80R02,38006002007FFE0K0F80R02,3800780300FHFE0g02,3FQFE0g02,:::3FgSFE,,::::::::::::::::::"
L"^XA^LH0,0^PO^FS"
L"^FO010,030^A0,30,25^FDSUPPLIER:SK hynix^FS"
L"^PRC"
L"^FO250,010^FR^XGHALOGEN_PKT,1,1^FS"
L"^FO450,030^A0,30,30^FD^FS"
L"^FO010,060^A0,30,30^FDDEVICE     :H9CKNNN8KTARKR-NTH^FS"
L"^FO010,085^A0,35,35^FDLOT NO. :T3LCY43G -TB ( 1 / 3 )^FS"
L"^BY2,2.5:1,60 ^FS"
L"^FO035,115^B3,N,40,Y,N,^FDT3LCY43G TB  001^FS"
L"^FO010,180^A0,22,22^FDITEM NO :120266-069(A3-3ALSHH0F-TAI-5055)^FS"
L"^BY2,2.3:1,60 ^FS"
L"^FO035,200^B3,N,40,Y,N,^FD120266-069  960^FS"
L"^FO010,300^A0,24,24^FDDATE CODE:1524^FS"
L"^FO010,265^A0,35,35^FDQ'TY: 960 EA^FS"
L"^FO010,325^A0,24,24^FDPACK DATE:2015/06/13^FS"
L"~DGON7PCSKH,1104,12,,O03JFC,N03LFC,N0NF,M07NFE,L01PF8,L07PFE,L0RF8,K03JF1MFC,K07JF1NF,J01KF1NF8,J03KFH0E3KFC,J07HF3HFH0638JFE,J0HFE3HF08731DJF,I01HFC3HF0C7H1C7IF8,I03FEC7HF8C70381IFC,I07F8C7HF8C703807HFE,I0HF841HF8C7070C78HF,H01HFCH07F8CF8F1C7CHF8,H01HFCH01JF0E1876HFC,H03HFE0C0IFC1F38E3HFC,H07FBE0E3IFC3HF0C3HFE,H0FE1F0OF187IF,H0FC3F87NFD8F3HF,01F8E187HFEH07IF0F1HF8001F980DIFJ07HF1F1HF8003F8H0IF8J01IFC3HFC003F808IFL0HFEH07FC007F838HFCL03HFH03FE007FCF9HF8L01HFE07FE007HFC1HFN0HFE3IF00IF83FEN07FE3IF00IF87FCN03FE7IF01LF8N01HF7IF81LF8O0LF81LFP0LF81KFEP07KF83KFEP07KFC3KFCP03KFC::3KFC01C03C07801KFC3KF801C0FE0FC01KFC3KF80360C318601KFC3KF80361803I01KFC3KF80H21803I01KFE7KF80631803I01KFE:3KF80HF98230401KFE3KF80HF8C318601KFC3KF80C18FE1FC01KFC3KF8180C7C07801KFC3KF8P01KFC3KFCP03KFC::3KFEP07KFC1KFEP07KF81LFP0LF8:1LF8N01LF80LFCN03LF00LFEN07LF00MFN0MF007LF8L01LFE007LFCL03LFE003LFEL07LFC003MF8J01MFC001MFEJ07MF8001NFCH03NF80H0gF,:H07XFE,H03XFC,:H01JFE01F01FC1KF8,I0JFE01EH0F81KF,I07IFE30E18780JFE,I03IFE38C3C780JFC,I01IFE38C7C708JF8,J0IFE38C7C7087IF,J07HFE38C2C7H07HFE,J03HFE38C206H07HFC,J01HFEH0EH0EH03HF8,K0HFE01FH063C3HF,K03FE03F8063E3FC,K01MF7JF8,L07PFE,L01PF8,M07NFE,M01NF8,N03LFC,O03JFC,Q07E,"
L"^FO490,170^FR^XGON7PCSKH,1,1^FS"
L"^FO010,350^A0,20,20^FDASSEMBLED IN KOREA FROM WAFER FABRICATED IN KOREA^FS"
L"^FO253,265^A0,16,16^FDAdditional information^FS"
L"^FO253,280^B7N,5,2,6,1,N^FDSK hynix            H9CKNNN8KTARKR-NTH            KR_KR     960    1524   T3LCY43G TB         001  ^FS"
L"^XZ^PQ",
//2
	L"^XA^LH0,0^PO^FS"
L"^BY1,2:1,60 ^FS"
L"^FO010,040^BCN,60,N,N,N,^FDSP4E8G0XGP-L040^FS"
L"^FO010,110^A0,40,30^FDDVC : SP4E8G0XGP-L040^FS"
L"^FO010,160^BCN,60,N,N,N,^FDT3LCY43G TB  001^FS"
L"^FO390,160^BCN,60,N,N,N,^FD 960^FS"
L"^FO010,230^A0,40,30^FDBOX ID : T3LCY43G TB  001^FS"
L"^FO0400,230^A0,40,30^FDQ'TY : 960^FS"
L"^FO120,280^BCN,60,N,N,N,^FDT3LCY43G TB  0010960^FS"
L"^FO160,350^A0,20,20^FDT3LCY43G TB  0010960^FS"
L"^XZ^PQ",
//3
	L"^XA^LH0,0^PO^FS"
L"^BY1,2:1,60 ^FS"
L"^FO010,040^BCN,60,N,N,N,^FDSP4E8G0XGP-L040^FS"
L"^FO010,110^A0,40,30^FDDVC : SP4E8G0XGP-L040^FS"
L"^FO010,160^BCN,60,N,N,N,^FDT3LCY43G TB  001^FS"
L"^FO390,160^BCN,60,N,N,N,^FD 960^FS"
L"^FO010,230^A0,40,30^FDBOX ID : T3LCY43G TB  001^FS"
L"^FO0400,230^A0,40,30^FDQ'TY : 960^FS"
L"^FO120,280^BCN,60,N,N,N,^FDT3LCY43G TB  0010960^FS"
L"^FO160,350^A0,20,20^FDT3LCY43G TB  0010960^FS"
L"^XZ^PQ",
//4
	L"^XA^LH0,0^PO^FS"
L"^FO010,010^A0,30,25^FD--------------------^FS"
L"^FO010,060^A0,30,30^FD SUPPLIER:SK hynix^FS"
L"^FO010,90^A0,30,30^FD DEVICE     :H9CKNNN8KTARKR-NTH^FS"
L"^FO010,120^A0,35,35^FD LOT NO. :T3LCY43G -TB ( 1 / 3 )^FS"
L"^FO010,240^A0,30,30^FD DATE CODE:1524^FS"
L"^FO310,240^A0,30,30^FD Q'TY: 960 EA^FS"
L"^BY2,2.5:1,60 ^FS"
L"^FO035,160^B3,N,40,Y,N,^FDT3LCY43G TB  001^FS"
L"^XZ^PQ",
//5
	L"~DGHALOGEN_PKT,01280,020,,:3FgSFE,3FQFE0g02,::3FJFE07FIFE0g02,3FJFC03FIFE0g02,3FJFC01FIFE0g02,3FJF800FIFE0g02,3FJF8007FC7E0g02,3FJF8003E01E0g02,3FJF8003800E0S06C0J02,3FJF80K0E3E018DF0F0J06C0J02,3FJF80K0E3E018DF1F0J060K02,3FJF80K0E367D8D8187DFDF6DF79DE2,3FJF80020H0E3E7DFDF187DADF6D14BD22,3FJFC0060H0E3E6DFDF186DADB6D14B1E2,3FJFC00E0H0E366D8C3186DADB6DF4B1E2,3FJFC00E001E367D8DF1F7DADF6D14BD02,3FJFE01F001E367D8DF0F7DADF6D149DE2,3FJFE01F003E0Q0180L02,3FKF01F007E0Q0180L02,3FKF83E00FE0Q0180L02,3FKF83E01FE0g02,3FKFC1E03FE0g02,3FKFE1C07FE0g02,3FLF801FFE330180K07C0M02,3FMF8FHFE330180K07C0M02,3FQFE337D80K060N02,3800780300FHFE3F7DBEF9F7C61DF7C0I02,38006002007FFE3F0DBEF916C7DD1440I02,380040H03C3FFE337DB6D9F6C7D9F7C0I02,38FF83FC7E3FFE337DB6D906C619040J02,38E007F8FF1FFE336DBEF906C619040J02,38E007F87F1FFE337DBEF9F6C619F7C0I02,38FFC3FC7E3FFE0L080R02,380040H03C3FFE0K0F80R02,38006002007FFE0K0F80R02,3800780300FHFE0g02,3FQFE0g02,:::3FgSFE,,::::::::::::::::::"
L"^XA^LH0,0^PO^FS"
L"^FO010,030^A0,30,25^FDSUPPLIER:SK hynix^FS"
L"^PRC"
L"^FO250,010^FR^XGHALOGEN_PKT,1,1^FS"
L"^FO450,030^A0,30,30^FD^FS"
L"^FO010,060^A0,30,30^FDDEVICE     :H9CKNNN8KTARKR-NTH^FS"
L"^FO010,085^A0,35,35^FDLOT NO. :T3LCY43G -TB ( 2 / 3 )^FS"
L"^BY2,2.5:1,60 ^FS"
L"^FO035,115^B3,N,40,Y,N,^FDT3LCY43G TB  002^FS"
L"^FO010,180^A0,22,22^FDITEM NO :120266-069(A3-3ALSHH0F-TAI-5055)^FS"
L"^BY2,2.3:1,60 ^FS"
L"^FO035,200^B3,N,40,Y,N,^FD120266-069  960^FS"
L"^FO010,300^A0,24,24^FDDATE CODE:1524^FS"
L"^FO010,265^A0,35,35^FDQ'TY: 960 EA^FS"
L"^FO010,325^A0,24,24^FDPACK DATE:2015/06/13^FS"
L"~DGON7PCSKH,1104,12,,O03JFC,N03LFC,N0NF,M07NFE,L01PF8,L07PFE,L0RF8,K03JF1MFC,K07JF1NF,J01KF1NF8,J03KFH0E3KFC,J07HF3HFH0638JFE,J0HFE3HF08731DJF,I01HFC3HF0C7H1C7IF8,I03FEC7HF8C70381IFC,I07F8C7HF8C703807HFE,I0HF841HF8C7070C78HF,H01HFCH07F8CF8F1C7CHF8,H01HFCH01JF0E1876HFC,H03HFE0C0IFC1F38E3HFC,H07FBE0E3IFC3HF0C3HFE,H0FE1F0OF187IF,H0FC3F87NFD8F3HF,01F8E187HFEH07IF0F1HF8001F980DIFJ07HF1F1HF8003F8H0IF8J01IFC3HFC003F808IFL0HFEH07FC007F838HFCL03HFH03FE007FCF9HF8L01HFE07FE007HFC1HFN0HFE3IF00IF83FEN07FE3IF00IF87FCN03FE7IF01LF8N01HF7IF81LF8O0LF81LFP0LF81KFEP07KF83KFEP07KFC3KFCP03KFC::3KFC01C03C07801KFC3KF801C0FE0FC01KFC3KF80360C318601KFC3KF80361803I01KFC3KF80H21803I01KFE7KF80631803I01KFE:3KF80HF98230401KFE3KF80HF8C318601KFC3KF80C18FE1FC01KFC3KF8180C7C07801KFC3KF8P01KFC3KFCP03KFC::3KFEP07KFC1KFEP07KF81LFP0LF8:1LF8N01LF80LFCN03LF00LFEN07LF00MFN0MF007LF8L01LFE007LFCL03LFE003LFEL07LFC003MF8J01MFC001MFEJ07MF8001NFCH03NF80H0gF,:H07XFE,H03XFC,:H01JFE01F01FC1KF8,I0JFE01EH0F81KF,I07IFE30E18780JFE,I03IFE38C3C780JFC,I01IFE38C7C708JF8,J0IFE38C7C7087IF,J07HFE38C2C7H07HFE,J03HFE38C206H07HFC,J01HFEH0EH0EH03HF8,K0HFE01FH063C3HF,K03FE03F8063E3FC,K01MF7JF8,L07PFE,L01PF8,M07NFE,M01NF8,N03LFC,O03JFC,Q07E,"
L"^FO490,170^FR^XGON7PCSKH,1,1^FS"
L"^FO010,350^A0,20,20^FDASSEMBLED IN KOREA FROM WAFER FABRICATED IN KOREA^FS"
L"^FO253,265^A0,16,16^FDAdditional information^FS"
L"^FO253,280^B7N,5,2,6,1,N^FDSK hynix            H9CKNNN8KTARKR-NTH            KR_KR     960    1524   T3LCY43G TB         002  ^FS"
L"^XZ^PQ",
//6	
	L"^XA^LH0,0^PO^FS"
L"^BY1,2:1,60 ^FS"
L"^FO010,040^BCN,60,N,N,N,^FDSP4E8G0XGP-L040^FS"
L"^FO010,110^A0,40,30^FDDVC : SP4E8G0XGP-L040^FS"
L"^FO010,160^BCN,60,N,N,N,^FDT3LCY43G TB  002^FS"
L"^FO390,160^BCN,60,N,N,N,^FD 960^FS"
L"^FO010,230^A0,40,30^FDBOX ID : T3LCY43G TB  002^FS"
L"^FO0400,230^A0,40,30^FDQ'TY : 960^FS"
L"^FO120,280^BCN,60,N,N,N,^FDT3LCY43G TB  0020960^FS"
L"^FO160,350^A0,20,20^FDT3LCY43G TB  0020960^FS"
L"^XZ^PQ",
//7
	L"^XA^LH0,0^PO^FS"
L"^BY1,2:1,60 ^FS"
L"^FO010,040^BCN,60,N,N,N,^FDSP4E8G0XGP-L040^FS"
L"^FO010,110^A0,40,30^FDDVC : SP4E8G0XGP-L040^FS"
L"^FO010,160^BCN,60,N,N,N,^FDT3LCY43G TB  002^FS"
L"^FO390,160^BCN,60,N,N,N,^FD 960^FS"
L"^FO010,230^A0,40,30^FDBOX ID : T3LCY43G TB  002^FS"
L"^FO0400,230^A0,40,30^FDQ'TY : 960^FS"
L"^FO120,280^BCN,60,N,N,N,^FDT3LCY43G TB  0020960^FS"
L"^FO160,350^A0,20,20^FDT3LCY43G TB  0020960^FS"
L"^XZ^PQ",
//8
	L"^XA^LH0,0^PO^FS"
L"^FO010,010^A0,30,25^FD--------------------^FS"
L"^FO010,060^A0,30,30^FD SUPPLIER:SK hynix^FS"
L"^FO010,90^A0,30,30^FD DEVICE     :H9CKNNN8KTARKR-NTH^FS"
L"^FO010,120^A0,35,35^FD LOT NO. :T3LCY43G -TB ( 2 / 3 )^FS"
L"^FO010,240^A0,30,30^FD DATE CODE:1524^FS"
L"^FO310,240^A0,30,30^FD Q'TY: 960 EA^FS"
L"^BY2,2.5:1,60 ^FS"
L"^FO035,160^B3,N,40,Y,N,^FDT3LCY43G TB  002^FS"
L"^XZ^PQ",
//9
	L">>>>>>>>>>^FX Precompiled file for C:\\Program Files\\Miracom Inc\\MESPlus\\HALOGEN_PKT.BMP width (pixels)=142 height (pixels)=47^FS"
L"^FX Scale factors: xf=1.001 yf=0.745 orientation=0 scaled width (bytes)=18 scaled height (bits)=35^FS"
L"~DGHALOGEN_PKT,01280,020,,:3FgSFE,3FQFE0g02,::3FJFE07FIFE0g02,3FJFC03FIFE0g02,3FJFC01FIFE0g02,3FJF800FIFE0g02,3FJF8007FC7E0g02,3FJF8003E01E0g02,3FJF8003800E0S06C0J02,3FJF80K0E3E018DF0F0J06C0J02,3FJF80K0E3E018DF1F0J060K02,3FJF80K0E367D8D8187DFDF6DF79DE2,3FJF80020H0E3E7DFDF187DADF6D14BD22,3FJFC0060H0E3E6DFDF186DADB6D14B1E2,3FJFC00E0H0E366D8C3186DADB6DF4B1E2,3FJFC00E001E367D8DF1F7DADF6D14BD02,3FJFE01F001E367D8DF0F7DADF6D149DE2,3FJFE01F003E0Q0180L02,3FKF01F007E0Q0180L02,3FKF83E00FE0Q0180L02,3FKF83E01FE0g02,3FKFC1E03FE0g02,3FKFE1C07FE0g02,3FLF801FFE330180K07C0M02,3FMF8FHFE330180K07C0M02,3FQFE337D80K060N02,3800780300FHFE3F7DBEF9F7C61DF7C0I02,38006002007FFE3F0DBEF916C7DD1440I02,380040H03C3FFE337DB6D9F6C7D9F7C0I02,38FF83FC7E3FFE337DB6D906C619040J02,38E007F8FF1FFE336DBEF906C619040J02,38E007F87F1FFE337DBEF9F6C619F7C0I02,38FFC3FC7E3FFE0L080R02,380040H03C3FFE0K0F80R02,38006002007FFE0K0F80R02,3800780300FHFE0g02,3FQFE0g02,:::3FgSFE,,::::::::::::::::::"
L"^XA^LH0,0^PO^FS"
L"^FO010,030^A0,30,25^FDSUPPLIER:SK hynix^FS"
L"^PRC"
L"^FO250,010^FR^XGHALOGEN_PKT,1,1^FS"
L"^FO450,030^A0,30,30^FD^FS"
L"^FO010,060^A0,30,30^FDDEVICE     :H9CKNNN8KTARKR-NTH^FS"
L"^FO010,085^A0,35,35^FDLOT NO. :T3LCY43G -TB ( 3 / 3 )^FS"
L"^BY2,2.5:1,60 ^FS"
L"^FO035,115^B3,N,40,Y,N,^FDT3LCY43G TB  003^FS"
L"^FO010,180^A0,22,22^FDITEM NO :120266-069(A3-3ALSHH0F-TAI-5055)^FS"
L"^BY2,2.3:1,60 ^FS"
L"^FO035,200^B3,N,40,Y,N,^FD120266-069  368^FS"
L"^FO010,300^A0,24,24^FDDATE CODE:1524^FS"
L"^FO010,265^A0,35,35^FDQ'TY: 368 EA^FS"
L"^FO010,325^A0,24,24^FDPACK DATE:2015/06/13^FS"
L"^FX Precompiled file for C:\\PROGRA~1\\MIRACO~1\\MESPLUS\\SKHYNI~4.BMP width (pixels)=92 height (pixels)=92^FS"
L"^FX Scale factors: xf=1.001 yf=1.001 orientation=0 scaled width (bytes)=12 scaled height (bits)=92^FS"
L"~DGON7PCSKH,1104,12,,O03JFC,N03LFC,N0NF,M07NFE,L01PF8,L07PFE,L0RF8,K03JF1MFC,K07JF1NF,J01KF1NF8,J03KFH0E3KFC,J07HF3HFH0638JFE,J0HFE3HF08731DJF,I01HFC3HF0C7H1C7IF8,I03FEC7HF8C70381IFC,I07F8C7HF8C703807HFE,I0HF841HF8C7070C78HF,H01HFCH07F8CF8F1C7CHF8,H01HFCH01JF0E1876HFC,H03HFE0C0IFC1F38E3HFC,H07FBE0E3IFC3HF0C3HFE,H0FE1F0OF187IF,H0FC3F87NFD8F3HF,01F8E187HFEH07IF0F1HF8001F980DIFJ07HF1F1HF8003F8H0IF8J01IFC3HFC003F808IFL0HFEH07FC007F838HFCL03HFH03FE007FCF9HF8L01HFE07FE007HFC1HFN0HFE3IF00IF83FEN07FE3IF00IF87FCN03FE7IF01LF8N01HF7IF81LF8O0LF81LFP0LF81KFEP07KF83KFEP07KFC3KFCP03KFC::3KFC01C03C07801KFC3KF801C0FE0FC01KFC3KF80360C318601KFC3KF80361803I01KFC3KF80H21803I01KFE7KF80631803I01KFE:3KF80HF98230401KFE3KF80HF8C318601KFC3KF80C18FE1FC01KFC3KF8180C7C07801KFC3KF8P01KFC3KFCP03KFC::3KFEP07KFC1KFEP07KF81LFP0LF8:1LF8N01LF80LFCN03LF00LFEN07LF00MFN0MF007LF8L01LFE007LFCL03LFE003LFEL07LFC003MF8J01MFC001MFEJ07MF8001NFCH03NF80H0gF,:H07XFE,H03XFC,:H01JFE01F01FC1KF8,I0JFE01EH0F81KF,I07IFE30E18780JFE,I03IFE38C3C780JFC,I01IFE38C7C708JF8,J0IFE38C7C7087IF,J07HFE38C2C7H07HFE,J03HFE38C206H07HFC,J01HFEH0EH0EH03HF8,K0HFE01FH063C3HF,K03FE03F8063E3FC,K01MF7JF8,L07PFE,L01PF8,M07NFE,M01NF8,N03LFC,O03JFC,Q07E,"
L"^FO490,170^FR^XGON7PCSKH,1,1^FS"
L"^FO010,350^A0,20,20^FDASSEMBLED IN KOREA FROM WAFER FABRICATED IN KOREA^FS"
L"^FO253,265^A0,16,16^FDAdditional information^FS"
L"^FO253,280^B7N,5,2,6,1,N^FDSK hynix            H9CKNNN8KTARKR-NTH            KR_KR     368    1524   T3LCY43G TB         003  ^FS"
L"^XZ^PQ",
//10
	L"^XA^LH0,0^PO^FS"
L"^BY1,2:1,60 ^FS"
L"^FO010,040^BCN,60,N,N,N,^FDSP4E8G0XGP-L040^FS"
L"^FO010,110^A0,40,30^FDDVC : SP4E8G0XGP-L040^FS"
L"^FO010,160^BCN,60,N,N,N,^FDT3LCY43G TB  003^FS"
L"^FO390,160^BCN,60,N,N,N,^FD 368^FS"
L"^FO010,230^A0,40,30^FDBOX ID : T3LCY43G TB  003^FS"
L"^FO0400,230^A0,40,30^FDQ'TY : 368^FS"
L"^FO120,280^BCN,60,N,N,N,^FDT3LCY43G TB  0030368^FS"
L"^FO160,350^A0,20,20^FDT3LCY43G TB  0030368^FS"
L"^XZ^PQ",
	//m_strZPL10 = L"^XA^LH0,0^PO^FS^BY1,2:1,60 ^FS^FO010,040^BCN,60,N,N,N,^FDSP4E8G0XGP-L040^FS^FO010,110^A0,40,30^FDDVC : SP4E8G0XGP-L040^FS^FO010,160^BCN,60,N,N,N,^FDT3LCY43G TB  003^FS^FO390,160^BCN,60,N,N,N,^FD 368^FS^FO010,230^A0,40,30^FDBOX ID : T3LCY43G TB  003^FS^FO0400,230^A0,40,30^FDQ'TY : 368^FS^FO120,280^BCN,60,N,N,N,^FDT3LCY43G TB  0030368^FS^FO160,350^A0,20,20^FDT3LCY43G TB  0030368^FS^XZ^PQ";
//11	
	L"^XA^LH0,0^PO^FS"
L"^BY1,2:1,60 ^FS"
L"^FO010,040^BCN,60,N,N,N,^FDSP4E8G0XGP-L040^FS"
L"^FO010,110^A0,40,30^FDDVC : SP4E8G0XGP-L040^FS"
L"^FO010,160^BCN,60,N,N,N,^FDT3LCY43G TB  003^FS"
L"^FO390,160^BCN,60,N,N,N,^FD 368^FS"
L"^FO010,230^A0,40,30^FDBOX ID : T3LCY43G TB  003^FS"
L"^FO0400,230^A0,40,30^FDQ'TY : 368^FS"
L"^FO120,280^BCN,60,N,N,N,^FDT3LCY43G TB  0030368^FS"
L"^FO160,350^A0,20,20^FDT3LCY43G TB  0030368^FS"
L"^XZ^PQ",
//12
	L"^XA^LH0,0^PO^FS"
L"^FO010,010^A0,30,25^FD--------------------^FS"
L"^FO010,060^A0,30,30^FD SUPPLIER:SK hynix^FS"
L"^FO010,90^A0,30,30^FD DEVICE     :H9CKNNN8KTARKR-NTH^FS"
L"^FO010,120^A0,35,35^FD LOT NO. :T3LCY43G -TB ( 3 / 3 )^FS"
L"^FO010,240^A0,30,30^FD DATE CODE:1524^FS"
L"^FO310,240^A0,30,30^FD Q'TY: 368 EA^FS"
L"^BY2,2.5:1,60 ^FS"
L"^FO035,160^B3,N,40,Y,N,^FDT3LCY43G TB  003^FS"
L"^XZ^PQ",

/////////////////////////////////////////////////////13~32(T3LCZ80A 1S1)
//13	
	L"^FX Precompiled file for C:\\Program Files\\Miracom Inc\\MESPlus\\HALOGEN_PKT.BMP width (pixels)=142 height (pixels)=47^FS"
L"^FX Scale factors: xf=1.001 yf=0.745 orientation=0 scaled width (bytes)=18 scaled height (bits)=35^FS"
L"~DGHALOGEN_PKT,01280,020,,:3FgSFE,3FQFE0g02,::3FJFE07FIFE0g02,3FJFC03FIFE0g02,3FJFC01FIFE0g02,3FJF800FIFE0g02,3FJF8007FC7E0g02,3FJF8003E01E0g02,3FJF8003800E0S06C0J02,3FJF80K0E3E018DF0F0J06C0J02,3FJF80K0E3E018DF1F0J060K02,3FJF80K0E367D8D8187DFDF6DF79DE2,3FJF80020H0E3E7DFDF187DADF6D14BD22,3FJFC0060H0E3E6DFDF186DADB6D14B1E2,3FJFC00E0H0E366D8C3186DADB6DF4B1E2,3FJFC00E001E367D8DF1F7DADF6D14BD02,3FJFE01F001E367D8DF0F7DADF6D149DE2,3FJFE01F003E0Q0180L02,3FKF01F007E0Q0180L02,3FKF83E00FE0Q0180L02,3FKF83E01FE0g02,3FKFC1E03FE0g02,3FKFE1C07FE0g02,3FLF801FFE330180K07C0M02,3FMF8FHFE330180K07C0M02,3FQFE337D80K060N02,3800780300FHFE3F7DBEF9F7C61DF7C0I02,38006002007FFE3F0DBEF916C7DD1440I02,380040H03C3FFE337DB6D9F6C7D9F7C0I02,38FF83FC7E3FFE337DB6D906C619040J02,38E007F8FF1FFE336DBEF906C619040J02,38E007F87F1FFE337DBEF9F6C619F7C0I02,38FFC3FC7E3FFE0L080R02,380040H03C3FFE0K0F80R02,38006002007FFE0K0F80R02,3800780300FHFE0g02,3FQFE0g02,:::3FgSFE,,::::::::::::::::::"
L"^XA^LH0,0^PO^FS"
L"^FO010,030^A0,30,25^FDSUPPLIER:SK hynix^FS"
L"^PRC"
L"^FO250,010^FR^XGHALOGEN_PKT,1,1^FS"
L"^FO450,030^A0,30,30^FD^FS"
L"^FO010,060^A0,30,30^FDDEVICE     :H9CKNNN8KTARKR-NTH^FS"
L"^FO010,085^A0,35,35^FDLOT NO. :T3LCZ80A -1S1( 1 / 5 )^FS"
L"^BY2,2.5:1,60 ^FS"
L"^FO035,115^B3,N,40,Y,N,^FDT3LCZ80A 1S1 001^FS"
L"^FO010,180^A0,22,22^FDITEM NO :120266-087(A3-3ALSHH0F-TAI-6536)^FS"
L"^BY2,2.3:1,60 ^FS"
L"^FO035,200^B3,N,40,Y,N,^FD120266-087  960^FS"
L"^FO010,300^A0,24,24^FDDATE CODE:1524^FS"
L"^FO010,265^A0,35,35^FDQ'TY: 960 EA^FS"
L"^FO010,325^A0,24,24^FDPACK DATE:2015/06/13^FS"
L"^FX Precompiled file for C:\\PROGRA~1\\MIRACO~1\\MESPLUS\\SKHYNI~4.BMP width (pixels)=92 height (pixels)=92^FS"
L"^FX Scale factors: xf=1.001 yf=1.001 orientation=0 scaled width (bytes)=12 scaled height (bits)=92^FS"
L"~DGON7PCSKH,1104,12,,O03JFC,N03LFC,N0NF,M07NFE,L01PF8,L07PFE,L0RF8,K03JF1MFC,K07JF1NF,J01KF1NF8,J03KFH0E3KFC,J07HF3HFH0638JFE,J0HFE3HF08731DJF,I01HFC3HF0C7H1C7IF8,I03FEC7HF8C70381IFC,I07F8C7HF8C703807HFE,I0HF841HF8C7070C78HF,H01HFCH07F8CF8F1C7CHF8,H01HFCH01JF0E1876HFC,H03HFE0C0IFC1F38E3HFC,H07FBE0E3IFC3HF0C3HFE,H0FE1F0OF187IF,H0FC3F87NFD8F3HF,01F8E187HFEH07IF0F1HF8001F980DIFJ07HF1F1HF8003F8H0IF8J01IFC3HFC003F808IFL0HFEH07FC007F838HFCL03HFH03FE007FCF9HF8L01HFE07FE007HFC1HFN0HFE3IF00IF83FEN07FE3IF00IF87FCN03FE7IF01LF8N01HF7IF81LF8O0LF81LFP0LF81KFEP07KF83KFEP07KFC3KFCP03KFC::3KFC01C03C07801KFC3KF801C0FE0FC01KFC3KF80360C318601KFC3KF80361803I01KFC3KF80H21803I01KFE7KF80631803I01KFE:3KF80HF98230401KFE3KF80HF8C318601KFC3KF80C18FE1FC01KFC3KF8180C7C07801KFC3KF8P01KFC3KFCP03KFC::3KFEP07KFC1KFEP07KF81LFP0LF8:1LF8N01LF80LFCN03LF00LFEN07LF00MFN0MF007LF8L01LFE007LFCL03LFE003LFEL07LFC003MF8J01MFC001MFEJ07MF8001NFCH03NF80H0gF,:H07XFE,H03XFC,:H01JFE01F01FC1KF8,I0JFE01EH0F81KF,I07IFE30E18780JFE,I03IFE38C3C780JFC,I01IFE38C7C708JF8,J0IFE38C7C7087IF,J07HFE38C2C7H07HFE,J03HFE38C206H07HFC,J01HFEH0EH0EH03HF8,K0HFE01FH063C3HF,K03FE03F8063E3FC,K01MF7JF8,L07PFE,L01PF8,M07NFE,M01NF8,N03LFC,O03JFC,Q07E,"
L"^FO490,170^FR^XGON7PCSKH,1,1^FS"
L"^FO010,350^A0,20,20^FDASSEMBLED IN KOREA FROM WAFER FABRICATED IN KOREA^FS"
L"^FO253,265^A0,16,16^FDAdditional information^FS"
L"^FO253,280^B7N,5,2,6,1,N^FDSK hynix            H9CKNNN8KTARKR-NTH            KR_KR     960    1524   T3LCZ80A 1S1        001  ^FS"
L"^XZ^PQ",
//14
	L"^XA^LH0,0^PO^FS"
L"^BY1,2:1,60 ^FS"
L"^FO010,040^BCN,60,N,N,N,^FDSP4E8G0XGP-L040^FS"
L"^FO010,110^A0,40,30^FDDVC : SP4E8G0XGP-L040^FS"
L"^FO010,160^BCN,60,N,N,N,^FDT3LCZ80A 1S1 001^FS"
L"^FO390,160^BCN,60,N,N,N,^FD 960^FS"
L"^FO010,230^A0,40,30^FDBOX ID : T3LCZ80A 1S1 001^FS"
L"^FO0400,230^A0,40,30^FDQ'TY : 960^FS"
L"^FO120,280^BCN,60,N,N,N,^FDT3LCZ80A 1S1 0010960^FS"
L"^FO160,350^A0,20,20^FDT3LCZ80A 1S1 0010960^FS"
L"^XZ^PQ",
//15
	L"^XA^LH0,0^PO^FS"
L"^BY1,2:1,60 ^FS"
L"^FO010,040^BCN,60,N,N,N,^FDSP4E8G0XGP-L040^FS"
L"^FO010,110^A0,40,30^FDDVC : SP4E8G0XGP-L040^FS"
L"^FO010,160^BCN,60,N,N,N,^FDT3LCZ80A 1S1 001^FS"
L"^FO390,160^BCN,60,N,N,N,^FD 960^FS"
L"^FO010,230^A0,40,30^FDBOX ID : T3LCZ80A 1S1 001^FS"
L"^FO0400,230^A0,40,30^FDQ'TY : 960^FS"
L"^FO120,280^BCN,60,N,N,N,^FDT3LCZ80A 1S1 0010960^FS"
L"^FO160,350^A0,20,20^FDT3LCZ80A 1S1 0010960^FS"
L"^XZ^PQ",
//16
	L"^XA^LH0,0^PO^FS"
L"^FO010,010^A0,30,25^FD--------------------^FS"
L"^FO010,060^A0,30,30^FD SUPPLIER:SK hynix^FS"
L"^FO010,90^A0,30,30^FD DEVICE     :H9CKNNN8KTARKR-NTH^FS"
L"^FO010,120^A0,35,35^FD LOT NO. :T3LCZ80A -1S1( 1 / 5 )^FS"
L"^FO010,240^A0,30,30^FD DATE CODE:1524^FS"
L"^FO310,240^A0,30,30^FD Q'TY: 960 EA^FS"
L"^BY2,2.5:1,60 ^FS"
L"^FO035,160^B3,N,40,Y,N,^FDT3LCZ80A 1S1 001^FS"
L"^XZ^PQ",
//17
	L">>>>>>>>>>^FX Precompiled file for C:\\Program Files\\Miracom Inc\\MESPlus\\HALOGEN_PKT.BMP width (pixels)=142 height (pixels)=47^FS"
L"^FX Scale factors: xf=1.001 yf=0.745 orientation=0 scaled width (bytes)=18 scaled height (bits)=35^FS"
L"~DGHALOGEN_PKT,01280,020,,:3FgSFE,3FQFE0g02,::3FJFE07FIFE0g02,3FJFC03FIFE0g02,3FJFC01FIFE0g02,3FJF800FIFE0g02,3FJF8007FC7E0g02,3FJF8003E01E0g02,3FJF8003800E0S06C0J02,3FJF80K0E3E018DF0F0J06C0J02,3FJF80K0E3E018DF1F0J060K02,3FJF80K0E367D8D8187DFDF6DF79DE2,3FJF80020H0E3E7DFDF187DADF6D14BD22,3FJFC0060H0E3E6DFDF186DADB6D14B1E2,3FJFC00E0H0E366D8C3186DADB6DF4B1E2,3FJFC00E001E367D8DF1F7DADF6D14BD02,3FJFE01F001E367D8DF0F7DADF6D149DE2,3FJFE01F003E0Q0180L02,3FKF01F007E0Q0180L02,3FKF83E00FE0Q0180L02,3FKF83E01FE0g02,3FKFC1E03FE0g02,3FKFE1C07FE0g02,3FLF801FFE330180K07C0M02,3FMF8FHFE330180K07C0M02,3FQFE337D80K060N02,3800780300FHFE3F7DBEF9F7C61DF7C0I02,38006002007FFE3F0DBEF916C7DD1440I02,380040H03C3FFE337DB6D9F6C7D9F7C0I02,38FF83FC7E3FFE337DB6D906C619040J02,38E007F8FF1FFE336DBEF906C619040J02,38E007F87F1FFE337DBEF9F6C619F7C0I02,38FFC3FC7E3FFE0L080R02,380040H03C3FFE0K0F80R02,38006002007FFE0K0F80R02,3800780300FHFE0g02,3FQFE0g02,:::3FgSFE,,::::::::::::::::::"
L"^XA^LH0,0^PO^FS"
L"^FO010,030^A0,30,25^FDSUPPLIER:SK hynix^FS"
L"^PRC"
L"^FO250,010^FR^XGHALOGEN_PKT,1,1^FS"
L"^FO450,030^A0,30,30^FD^FS"
L"^FO010,060^A0,30,30^FDDEVICE     :H9CKNNN8KTARKR-NTH^FS"
L"^FO010,085^A0,35,35^FDLOT NO. :T3LCZ80A -1S1( 2 / 5 )^FS"
L"^BY2,2.5:1,60 ^FS"
L"^FO035,115^B3,N,40,Y,N,^FDT3LCZ80A 1S1 002^FS"
L"^FO010,180^A0,22,22^FDITEM NO :120266-087(A3-3ALSHH0F-TAI-6536)^FS"
L"^BY2,2.3:1,60 ^FS"
L"^FO035,200^B3,N,40,Y,N,^FD120266-087  960^FS"
L"^FO010,300^A0,24,24^FDDATE CODE:1524^FS"
L"^FO010,265^A0,35,35^FDQ'TY: 960 EA^FS"
L"^FO010,325^A0,24,24^FDPACK DATE:2015/06/13^FS"
L"^FX Precompiled file for C:\\PROGRA~1\\MIRACO~1\\MESPLUS\\SKHYNI~4.BMP width (pixels)=92 height (pixels)=92^FS"
L"^FX Scale factors: xf=1.001 yf=1.001 orientation=0 scaled width (bytes)=12 scaled height (bits)=92^FS"
L"~DGON7PCSKH,1104,12,,O03JFC,N03LFC,N0NF,M07NFE,L01PF8,L07PFE,L0RF8,K03JF1MFC,K07JF1NF,J01KF1NF8,J03KFH0E3KFC,J07HF3HFH0638JFE,J0HFE3HF08731DJF,I01HFC3HF0C7H1C7IF8,I03FEC7HF8C70381IFC,I07F8C7HF8C703807HFE,I0HF841HF8C7070C78HF,H01HFCH07F8CF8F1C7CHF8,H01HFCH01JF0E1876HFC,H03HFE0C0IFC1F38E3HFC,H07FBE0E3IFC3HF0C3HFE,H0FE1F0OF187IF,H0FC3F87NFD8F3HF,01F8E187HFEH07IF0F1HF8001F980DIFJ07HF1F1HF8003F8H0IF8J01IFC3HFC003F808IFL0HFEH07FC007F838HFCL03HFH03FE007FCF9HF8L01HFE07FE007HFC1HFN0HFE3IF00IF83FEN07FE3IF00IF87FCN03FE7IF01LF8N01HF7IF81LF8O0LF81LFP0LF81KFEP07KF83KFEP07KFC3KFCP03KFC::3KFC01C03C07801KFC3KF801C0FE0FC01KFC3KF80360C318601KFC3KF80361803I01KFC3KF80H21803I01KFE7KF80631803I01KFE:3KF80HF98230401KFE3KF80HF8C318601KFC3KF80C18FE1FC01KFC3KF8180C7C07801KFC3KF8P01KFC3KFCP03KFC::3KFEP07KFC1KFEP07KF81LFP0LF8:1LF8N01LF80LFCN03LF00LFEN07LF00MFN0MF007LF8L01LFE007LFCL03LFE003LFEL07LFC003MF8J01MFC001MFEJ07MF8001NFCH03NF80H0gF,:H07XFE,H03XFC,:H01JFE01F01FC1KF8,I0JFE01EH0F81KF,I07IFE30E18780JFE,I03IFE38C3C780JFC,I01IFE38C7C708JF8,J0IFE38C7C7087IF,J07HFE38C2C7H07HFE,J03HFE38C206H07HFC,J01HFEH0EH0EH03HF8,K0HFE01FH063C3HF,K03FE03F8063E3FC,K01MF7JF8,L07PFE,L01PF8,M07NFE,M01NF8,N03LFC,O03JFC,Q07E,"
L"^FO490,170^FR^XGON7PCSKH,1,1^FS"
L"^FO010,350^A0,20,20^FDASSEMBLED IN KOREA FROM WAFER FABRICATED IN KOREA^FS"
L"^FO253,265^A0,16,16^FDAdditional information^FS"
L"^FO253,280^B7N,5,2,6,1,N^FDSK hynix            H9CKNNN8KTARKR-NTH            KR_KR     960    1524   T3LCZ80A 1S1        002  ^FS"
L"^XZ^PQ",
//18
	L"^XA^LH0,0^PO^FS"
L"^BY1,2:1,60 ^FS"
L"^FO010,040^BCN,60,N,N,N,^FDSP4E8G0XGP-L040^FS"
L"^FO010,110^A0,40,30^FDDVC : SP4E8G0XGP-L040^FS"
L"^FO010,160^BCN,60,N,N,N,^FDT3LCZ80A 1S1 002^FS"
L"^FO390,160^BCN,60,N,N,N,^FD 960^FS"
L"^FO010,230^A0,40,30^FDBOX ID : T3LCZ80A 1S1 002^FS"
L"^FO0400,230^A0,40,30^FDQ'TY : 960^FS"
L"^FO120,280^BCN,60,N,N,N,^FDT3LCZ80A 1S1 0020960^FS"
L"^FO160,350^A0,20,20^FDT3LCZ80A 1S1 0020960^FS"
L"^XZ^PQ",
//19
	L"^XA^LH0,0^PO^FS"
L"^BY1,2:1,60 ^FS"
L"^FO010,040^BCN,60,N,N,N,^FDSP4E8G0XGP-L040^FS"
L"^FO010,110^A0,40,30^FDDVC : SP4E8G0XGP-L040^FS"
L"^FO010,160^BCN,60,N,N,N,^FDT3LCZ80A 1S1 002^FS"
L"^FO390,160^BCN,60,N,N,N,^FD 960^FS"
L"^FO010,230^A0,40,30^FDBOX ID : T3LCZ80A 1S1 002^FS"
L"^FO0400,230^A0,40,30^FDQ'TY : 960^FS"
L"^FO120,280^BCN,60,N,N,N,^FDT3LCZ80A 1S1 0020960^FS"
L"^FO160,350^A0,20,20^FDT3LCZ80A 1S1 0020960^FS"
L"^XZ^PQ",
//20
	L"^XA^LH0,0^PO^FS"
L"^FO010,010^A0,30,25^FD--------------------^FS"
L"^FO010,060^A0,30,30^FD SUPPLIER:SK hynix^FS"
L"^FO010,90^A0,30,30^FD DEVICE     :H9CKNNN8KTARKR-NTH^FS"
L"^FO010,120^A0,35,35^FD LOT NO. :T3LCZ80A -1S1( 2 / 5 )^FS"
L"^FO010,240^A0,30,30^FD DATE CODE:1524^FS"
L"^FO310,240^A0,30,30^FD Q'TY: 960 EA^FS"
L"^BY2,2.5:1,60 ^FS"
L"^FO035,160^B3,N,40,Y,N,^FDT3LCZ80A 1S1 002^FS"
L"^XZ^PQ",
//21
	L">>>>>>>>>>^FX Precompiled file for C:\\Program Files\\Miracom Inc\\MESPlus\\HALOGEN_PKT.BMP width (pixels)=142 height (pixels)=47^FS"
L"^FX Scale factors: xf=1.001 yf=0.745 orientation=0 scaled width (bytes)=18 scaled height (bits)=35^FS"
L"~DGHALOGEN_PKT,01280,020,,:3FgSFE,3FQFE0g02,::3FJFE07FIFE0g02,3FJFC03FIFE0g02,3FJFC01FIFE0g02,3FJF800FIFE0g02,3FJF8007FC7E0g02,3FJF8003E01E0g02,3FJF8003800E0S06C0J02,3FJF80K0E3E018DF0F0J06C0J02,3FJF80K0E3E018DF1F0J060K02,3FJF80K0E367D8D8187DFDF6DF79DE2,3FJF80020H0E3E7DFDF187DADF6D14BD22,3FJFC0060H0E3E6DFDF186DADB6D14B1E2,3FJFC00E0H0E366D8C3186DADB6DF4B1E2,3FJFC00E001E367D8DF1F7DADF6D14BD02,3FJFE01F001E367D8DF0F7DADF6D149DE2,3FJFE01F003E0Q0180L02,3FKF01F007E0Q0180L02,3FKF83E00FE0Q0180L02,3FKF83E01FE0g02,3FKFC1E03FE0g02,3FKFE1C07FE0g02,3FLF801FFE330180K07C0M02,3FMF8FHFE330180K07C0M02,3FQFE337D80K060N02,3800780300FHFE3F7DBEF9F7C61DF7C0I02,38006002007FFE3F0DBEF916C7DD1440I02,380040H03C3FFE337DB6D9F6C7D9F7C0I02,38FF83FC7E3FFE337DB6D906C619040J02,38E007F8FF1FFE336DBEF906C619040J02,38E007F87F1FFE337DBEF9F6C619F7C0I02,38FFC3FC7E3FFE0L080R02,380040H03C3FFE0K0F80R02,38006002007FFE0K0F80R02,3800780300FHFE0g02,3FQFE0g02,:::3FgSFE,,::::::::::::::::::"
L"^XA^LH0,0^PO^FS"
L"^FO010,030^A0,30,25^FDSUPPLIER:SK hynix^FS"
L"^PRC"
L"^FO250,010^FR^XGHALOGEN_PKT,1,1^FS"
L"^FO450,030^A0,30,30^FD^FS"
L"^FO010,060^A0,30,30^FDDEVICE     :H9CKNNN8KTARKR-NTH^FS"
L"^FO010,085^A0,35,35^FDLOT NO. :T3LCZ80A -1S1( 3 / 5 )^FS"
L"^BY2,2.5:1,60 ^FS"
L"^FO035,115^B3,N,40,Y,N,^FDT3LCZ80A 1S1 003^FS"
L"^FO010,180^A0,22,22^FDITEM NO :120266-087(A3-3ALSHH0F-TAI-6536)^FS"
L"^BY2,2.3:1,60 ^FS"
L"^FO035,200^B3,N,40,Y,N,^FD120266-087  960^FS"
L"^FO010,300^A0,24,24^FDDATE CODE:1524^FS"
L"^FO010,265^A0,35,35^FDQ'TY: 960 EA^FS"
L"^FO010,325^A0,24,24^FDPACK DATE:2015/06/13^FS"
L"^FX Precompiled file for C:\\PROGRA~1\\MIRACO~1\\MESPLUS\\SKHYNI~4.BMP width (pixels)=92 height (pixels)=92^FS"
L"^FX Scale factors: xf=1.001 yf=1.001 orientation=0 scaled width (bytes)=12 scaled height (bits)=92^FS"
L"~DGON7PCSKH,1104,12,,O03JFC,N03LFC,N0NF,M07NFE,L01PF8,L07PFE,L0RF8,K03JF1MFC,K07JF1NF,J01KF1NF8,J03KFH0E3KFC,J07HF3HFH0638JFE,J0HFE3HF08731DJF,I01HFC3HF0C7H1C7IF8,I03FEC7HF8C70381IFC,I07F8C7HF8C703807HFE,I0HF841HF8C7070C78HF,H01HFCH07F8CF8F1C7CHF8,H01HFCH01JF0E1876HFC,H03HFE0C0IFC1F38E3HFC,H07FBE0E3IFC3HF0C3HFE,H0FE1F0OF187IF,H0FC3F87NFD8F3HF,01F8E187HFEH07IF0F1HF8001F980DIFJ07HF1F1HF8003F8H0IF8J01IFC3HFC003F808IFL0HFEH07FC007F838HFCL03HFH03FE007FCF9HF8L01HFE07FE007HFC1HFN0HFE3IF00IF83FEN07FE3IF00IF87FCN03FE7IF01LF8N01HF7IF81LF8O0LF81LFP0LF81KFEP07KF83KFEP07KFC3KFCP03KFC::3KFC01C03C07801KFC3KF801C0FE0FC01KFC3KF80360C318601KFC3KF80361803I01KFC3KF80H21803I01KFE7KF80631803I01KFE:3KF80HF98230401KFE3KF80HF8C318601KFC3KF80C18FE1FC01KFC3KF8180C7C07801KFC3KF8P01KFC3KFCP03KFC::3KFEP07KFC1KFEP07KF81LFP0LF8:1LF8N01LF80LFCN03LF00LFEN07LF00MFN0MF007LF8L01LFE007LFCL03LFE003LFEL07LFC003MF8J01MFC001MFEJ07MF8001NFCH03NF80H0gF,:H07XFE,H03XFC,:H01JFE01F01FC1KF8,I0JFE01EH0F81KF,I07IFE30E18780JFE,I03IFE38C3C780JFC,I01IFE38C7C708JF8,J0IFE38C7C7087IF,J07HFE38C2C7H07HFE,J03HFE38C206H07HFC,J01HFEH0EH0EH03HF8,K0HFE01FH063C3HF,K03FE03F8063E3FC,K01MF7JF8,L07PFE,L01PF8,M07NFE,M01NF8,N03LFC,O03JFC,Q07E,"
L"^FO490,170^FR^XGON7PCSKH,1,1^FS"
L"^FO010,350^A0,20,20^FDASSEMBLED IN KOREA FROM WAFER FABRICATED IN KOREA^FS"
L"^FO253,265^A0,16,16^FDAdditional information^FS"
L"^FO253,280^B7N,5,2,6,1,N^FDSK hynix            H9CKNNN8KTARKR-NTH            KR_KR     960    1524   T3LCZ80A 1S1        003  ^FS"
L"^XZ^PQ",
//22	
	L"^XA^LH0,0^PO^FS"
L"^BY1,2:1,60 ^FS"
L"^FO010,040^BCN,60,N,N,N,^FDSP4E8G0XGP-L040^FS"
L"^FO010,110^A0,40,30^FDDVC : SP4E8G0XGP-L040^FS"
L"^FO010,160^BCN,60,N,N,N,^FDT3LCZ80A 1S1 003^FS"
L"^FO390,160^BCN,60,N,N,N,^FD 960^FS"
L"^FO010,230^A0,40,30^FDBOX ID : T3LCZ80A 1S1 003^FS"
L"^FO0400,230^A0,40,30^FDQ'TY : 960^FS"
L"^FO120,280^BCN,60,N,N,N,^FDT3LCZ80A 1S1 0030960^FS"
L"^FO160,350^A0,20,20^FDT3LCZ80A 1S1 0030960^FS"
L"^XZ^PQ",
//23
	L"^XA^LH0,0^PO^FS"
L"^BY1,2:1,60 ^FS"
L"^FO010,040^BCN,60,N,N,N,^FDSP4E8G0XGP-L040^FS"
L"^FO010,110^A0,40,30^FDDVC : SP4E8G0XGP-L040^FS"
L"^FO010,160^BCN,60,N,N,N,^FDT3LCZ80A 1S1 003^FS"
L"^FO390,160^BCN,60,N,N,N,^FD 960^FS"
L"^FO010,230^A0,40,30^FDBOX ID : T3LCZ80A 1S1 003^FS"
L"^FO0400,230^A0,40,30^FDQ'TY : 960^FS"
L"^FO120,280^BCN,60,N,N,N,^FDT3LCZ80A 1S1 0030960^FS"
L"^FO160,350^A0,20,20^FDT3LCZ80A 1S1 0030960^FS"
L"^XZ^PQ",
//24
	L"^XA^LH0,0^PO^FS"
L"^FO010,010^A0,30,25^FD--------------------^FS"
L"^FO010,060^A0,30,30^FD SUPPLIER:SK hynix^FS"
L"^FO010,90^A0,30,30^FD DEVICE     :H9CKNNN8KTARKR-NTH^FS"
L"^FO010,120^A0,35,35^FD LOT NO. :T3LCZ80A -1S1( 3 / 5 )^FS"
L"^FO010,240^A0,30,30^FD DATE CODE:1524^FS"
L"^FO310,240^A0,30,30^FD Q'TY: 960 EA^FS"
L"^BY2,2.5:1,60 ^FS"
L"^FO035,160^B3,N,40,Y,N,^FDT3LCZ80A 1S1 003^FS"
L"^XZ^PQ",
//25
	L">>>>>>>>>>^FX Precompiled file for C:\\Program Files\\Miracom Inc\\MESPlus\\HALOGEN_PKT.BMP width (pixels)=142 height (pixels)=47^FS"
L"^FX Scale factors: xf=1.001 yf=0.745 orientation=0 scaled width (bytes)=18 scaled height (bits)=35^FS"
L"~DGHALOGEN_PKT,01280,020,,:3FgSFE,3FQFE0g02,::3FJFE07FIFE0g02,3FJFC03FIFE0g02,3FJFC01FIFE0g02,3FJF800FIFE0g02,3FJF8007FC7E0g02,3FJF8003E01E0g02,3FJF8003800E0S06C0J02,3FJF80K0E3E018DF0F0J06C0J02,3FJF80K0E3E018DF1F0J060K02,3FJF80K0E367D8D8187DFDF6DF79DE2,3FJF80020H0E3E7DFDF187DADF6D14BD22,3FJFC0060H0E3E6DFDF186DADB6D14B1E2,3FJFC00E0H0E366D8C3186DADB6DF4B1E2,3FJFC00E001E367D8DF1F7DADF6D14BD02,3FJFE01F001E367D8DF0F7DADF6D149DE2,3FJFE01F003E0Q0180L02,3FKF01F007E0Q0180L02,3FKF83E00FE0Q0180L02,3FKF83E01FE0g02,3FKFC1E03FE0g02,3FKFE1C07FE0g02,3FLF801FFE330180K07C0M02,3FMF8FHFE330180K07C0M02,3FQFE337D80K060N02,3800780300FHFE3F7DBEF9F7C61DF7C0I02,38006002007FFE3F0DBEF916C7DD1440I02,380040H03C3FFE337DB6D9F6C7D9F7C0I02,38FF83FC7E3FFE337DB6D906C619040J02,38E007F8FF1FFE336DBEF906C619040J02,38E007F87F1FFE337DBEF9F6C619F7C0I02,38FFC3FC7E3FFE0L080R02,380040H03C3FFE0K0F80R02,38006002007FFE0K0F80R02,3800780300FHFE0g02,3FQFE0g02,:::3FgSFE,,::::::::::::::::::"
L"^XA^LH0,0^PO^FS"
L"^FO010,030^A0,30,25^FDSUPPLIER:SK hynix^FS"
L"^PRC"
L"^FO250,010^FR^XGHALOGEN_PKT,1,1^FS"
L"^FO450,030^A0,30,30^FD^FS"
L"^FO010,060^A0,30,30^FDDEVICE     :H9CKNNN8KTARKR-NTH^FS"
L"^FO010,085^A0,35,35^FDLOT NO. :T3LCZ80A -1S1( 4 / 5 )^FS"
L"^BY2,2.5:1,60 ^FS"
L"^FO035,115^B3,N,40,Y,N,^FDT3LCZ80A 1S1 004^FS"
L"^FO010,180^A0,22,22^FDITEM NO :120266-087(A3-3ALSHH0F-TAI-6536)^FS"
L"^BY2,2.3:1,60 ^FS"
L"^FO035,200^B3,N,40,Y,N,^FD120266-087  960^FS"
L"^FO010,300^A0,24,24^FDDATE CODE:1524^FS"
L"^FO010,265^A0,35,35^FDQ'TY: 960 EA^FS"
L"^FO010,325^A0,24,24^FDPACK DATE:2015/06/13^FS"
L"^FX Precompiled file for C:\\PROGRA~1\\MIRACO~1\\MESPLUS\\SKHYNI~4.BMP width (pixels)=92 height (pixels)=92^FS"
L"^FX Scale factors: xf=1.001 yf=1.001 orientation=0 scaled width (bytes)=12 scaled height (bits)=92^FS"
L"~DGON7PCSKH,1104,12,,O03JFC,N03LFC,N0NF,M07NFE,L01PF8,L07PFE,L0RF8,K03JF1MFC,K07JF1NF,J01KF1NF8,J03KFH0E3KFC,J07HF3HFH0638JFE,J0HFE3HF08731DJF,I01HFC3HF0C7H1C7IF8,I03FEC7HF8C70381IFC,I07F8C7HF8C703807HFE,I0HF841HF8C7070C78HF,H01HFCH07F8CF8F1C7CHF8,H01HFCH01JF0E1876HFC,H03HFE0C0IFC1F38E3HFC,H07FBE0E3IFC3HF0C3HFE,H0FE1F0OF187IF,H0FC3F87NFD8F3HF,01F8E187HFEH07IF0F1HF8001F980DIFJ07HF1F1HF8003F8H0IF8J01IFC3HFC003F808IFL0HFEH07FC007F838HFCL03HFH03FE007FCF9HF8L01HFE07FE007HFC1HFN0HFE3IF00IF83FEN07FE3IF00IF87FCN03FE7IF01LF8N01HF7IF81LF8O0LF81LFP0LF81KFEP07KF83KFEP07KFC3KFCP03KFC::3KFC01C03C07801KFC3KF801C0FE0FC01KFC3KF80360C318601KFC3KF80361803I01KFC3KF80H21803I01KFE7KF80631803I01KFE:3KF80HF98230401KFE3KF80HF8C318601KFC3KF80C18FE1FC01KFC3KF8180C7C07801KFC3KF8P01KFC3KFCP03KFC::3KFEP07KFC1KFEP07KF81LFP0LF8:1LF8N01LF80LFCN03LF00LFEN07LF00MFN0MF007LF8L01LFE007LFCL03LFE003LFEL07LFC003MF8J01MFC001MFEJ07MF8001NFCH03NF80H0gF,:H07XFE,H03XFC,:H01JFE01F01FC1KF8,I0JFE01EH0F81KF,I07IFE30E18780JFE,I03IFE38C3C780JFC,I01IFE38C7C708JF8,J0IFE38C7C7087IF,J07HFE38C2C7H07HFE,J03HFE38C206H07HFC,J01HFEH0EH0EH03HF8,K0HFE01FH063C3HF,K03FE03F8063E3FC,K01MF7JF8,L07PFE,L01PF8,M07NFE,M01NF8,N03LFC,O03JFC,Q07E,"
L"^FO490,170^FR^XGON7PCSKH,1,1^FS"
L"^FO010,350^A0,20,20^FDASSEMBLED IN KOREA FROM WAFER FABRICATED IN KOREA^FS"
L"^FO253,265^A0,16,16^FDAdditional information^FS"
L"^FO253,280^B7N,5,2,6,1,N^FDSK hynix            H9CKNNN8KTARKR-NTH            KR_KR     960    1524   T3LCZ80A 1S1        004  ^FS"
L"^XZ^PQ",
//26
	L"^XA^LH0,0^PO^FS"
L"^BY1,2:1,60 ^FS"
L"^FO010,040^BCN,60,N,N,N,^FDSP4E8G0XGP-L040^FS"
L"^FO010,110^A0,40,30^FDDVC : SP4E8G0XGP-L040^FS"
L"^FO010,160^BCN,60,N,N,N,^FDT3LCZ80A 1S1 004^FS"
L"^FO390,160^BCN,60,N,N,N,^FD 960^FS"
L"^FO010,230^A0,40,30^FDBOX ID : T3LCZ80A 1S1 004^FS"
L"^FO0400,230^A0,40,30^FDQ'TY : 960^FS"
L"^FO120,280^BCN,60,N,N,N,^FDT3LCZ80A 1S1 0040960^FS"
L"^FO160,350^A0,20,20^FDT3LCZ80A 1S1 0040960^FS"
L"^XZ^PQ",
//27
	L"^XA^LH0,0^PO^FS"
L"^BY1,2:1,60 ^FS"
L"^FO010,040^BCN,60,N,N,N,^FDSP4E8G0XGP-L040^FS"
L"^FO010,110^A0,40,30^FDDVC : SP4E8G0XGP-L040^FS"
L"^FO010,160^BCN,60,N,N,N,^FDT3LCZ80A 1S1 004^FS"
L"^FO390,160^BCN,60,N,N,N,^FD 960^FS"
L"^FO010,230^A0,40,30^FDBOX ID : T3LCZ80A 1S1 004^FS"
L"^FO0400,230^A0,40,30^FDQ'TY : 960^FS"
L"^FO120,280^BCN,60,N,N,N,^FDT3LCZ80A 1S1 0040960^FS"
L"^FO160,350^A0,20,20^FDT3LCZ80A 1S1 0040960^FS"
L"^XZ^PQ",
//28
	L"^XA^LH0,0^PO^FS"
L"^FO010,010^A0,30,25^FD--------------------^FS"
L"^FO010,060^A0,30,30^FD SUPPLIER:SK hynix^FS"
L"^FO010,90^A0,30,30^FD DEVICE     :H9CKNNN8KTARKR-NTH^FS"
L"^FO010,120^A0,35,35^FD LOT NO. :T3LCZ80A -1S1( 4 / 5 )^FS"
L"^FO010,240^A0,30,30^FD DATE CODE:1524^FS"
L"^FO310,240^A0,30,30^FD Q'TY: 960 EA^FS"
L"^BY2,2.5:1,60 ^FS"
L"^FO035,160^B3,N,40,Y,N,^FDT3LCZ80A 1S1 004^FS"
L"^XZ^PQ",
//29
	L">>>>>>>>>>^FX Precompiled file for C:\\Program Files\\Miracom Inc\\MESPlus\\HALOGEN_PKT.BMP width (pixels)=142 height (pixels)=47^FS"
L"^FX Scale factors: xf=1.001 yf=0.745 orientation=0 scaled width (bytes)=18 scaled height (bits)=35^FS"
L"~DGHALOGEN_PKT,01280,020,,:3FgSFE,3FQFE0g02,::3FJFE07FIFE0g02,3FJFC03FIFE0g02,3FJFC01FIFE0g02,3FJF800FIFE0g02,3FJF8007FC7E0g02,3FJF8003E01E0g02,3FJF8003800E0S06C0J02,3FJF80K0E3E018DF0F0J06C0J02,3FJF80K0E3E018DF1F0J060K02,3FJF80K0E367D8D8187DFDF6DF79DE2,3FJF80020H0E3E7DFDF187DADF6D14BD22,3FJFC0060H0E3E6DFDF186DADB6D14B1E2,3FJFC00E0H0E366D8C3186DADB6DF4B1E2,3FJFC00E001E367D8DF1F7DADF6D14BD02,3FJFE01F001E367D8DF0F7DADF6D149DE2,3FJFE01F003E0Q0180L02,3FKF01F007E0Q0180L02,3FKF83E00FE0Q0180L02,3FKF83E01FE0g02,3FKFC1E03FE0g02,3FKFE1C07FE0g02,3FLF801FFE330180K07C0M02,3FMF8FHFE330180K07C0M02,3FQFE337D80K060N02,3800780300FHFE3F7DBEF9F7C61DF7C0I02,38006002007FFE3F0DBEF916C7DD1440I02,380040H03C3FFE337DB6D9F6C7D9F7C0I02,38FF83FC7E3FFE337DB6D906C619040J02,38E007F8FF1FFE336DBEF906C619040J02,38E007F87F1FFE337DBEF9F6C619F7C0I02,38FFC3FC7E3FFE0L080R02,380040H03C3FFE0K0F80R02,38006002007FFE0K0F80R02,3800780300FHFE0g02,3FQFE0g02,:::3FgSFE,,::::::::::::::::::"
L"^XA^LH0,0^PO^FS"
L"^FO010,030^A0,30,25^FDSUPPLIER:SK hynix^FS"
L"^PRC"
L"^FO250,010^FR^XGHALOGEN_PKT,1,1^FS"
L"^FO450,030^A0,30,30^FD^FS"
L"^FO010,060^A0,30,30^FDDEVICE     :H9CKNNN8KTARKR-NTH^FS"
L"^FO010,085^A0,35,35^FDLOT NO. :T3LCZ80A -1S1( 5 / 5 )^FS"
L"^BY2,2.5:1,60 ^FS"
L"^FO035,115^B3,N,40,Y,N,^FDT3LCZ80A 1S1 005^FS"
L"^FO010,180^A0,22,22^FDITEM NO :120266-087(A3-3ALSHH0F-TAI-6536)^FS"
L"^BY2,2.3:1,60 ^FS"
L"^FO035,200^B3,N,40,Y,N,^FD120266-087  958^FS"
L"^FO010,300^A0,24,24^FDDATE CODE:1524^FS"
L"^FO010,265^A0,35,35^FDQ'TY: 958 EA^FS"
L"^FO010,325^A0,24,24^FDPACK DATE:2015/06/13^FS"
L"^FX Precompiled file for C:\\PROGRA~1\\MIRACO~1\\MESPLUS\\SKHYNI~4.BMP width (pixels)=92 height (pixels)=92^FS"
L"^FX Scale factors: xf=1.001 yf=1.001 orientation=0 scaled width (bytes)=12 scaled height (bits)=92^FS"
L"~DGON7PCSKH,1104,12,,O03JFC,N03LFC,N0NF,M07NFE,L01PF8,L07PFE,L0RF8,K03JF1MFC,K07JF1NF,J01KF1NF8,J03KFH0E3KFC,J07HF3HFH0638JFE,J0HFE3HF08731DJF,I01HFC3HF0C7H1C7IF8,I03FEC7HF8C70381IFC,I07F8C7HF8C703807HFE,I0HF841HF8C7070C78HF,H01HFCH07F8CF8F1C7CHF8,H01HFCH01JF0E1876HFC,H03HFE0C0IFC1F38E3HFC,H07FBE0E3IFC3HF0C3HFE,H0FE1F0OF187IF,H0FC3F87NFD8F3HF,01F8E187HFEH07IF0F1HF8001F980DIFJ07HF1F1HF8003F8H0IF8J01IFC3HFC003F808IFL0HFEH07FC007F838HFCL03HFH03FE007FCF9HF8L01HFE07FE007HFC1HFN0HFE3IF00IF83FEN07FE3IF00IF87FCN03FE7IF01LF8N01HF7IF81LF8O0LF81LFP0LF81KFEP07KF83KFEP07KFC3KFCP03KFC::3KFC01C03C07801KFC3KF801C0FE0FC01KFC3KF80360C318601KFC3KF80361803I01KFC3KF80H21803I01KFE7KF80631803I01KFE:3KF80HF98230401KFE3KF80HF8C318601KFC3KF80C18FE1FC01KFC3KF8180C7C07801KFC3KF8P01KFC3KFCP03KFC::3KFEP07KFC1KFEP07KF81LFP0LF8:1LF8N01LF80LFCN03LF00LFEN07LF00MFN0MF007LF8L01LFE007LFCL03LFE003LFEL07LFC003MF8J01MFC001MFEJ07MF8001NFCH03NF80H0gF,:H07XFE,H03XFC,:H01JFE01F01FC1KF8,I0JFE01EH0F81KF,I07IFE30E18780JFE,I03IFE38C3C780JFC,I01IFE38C7C708JF8,J0IFE38C7C7087IF,J07HFE38C2C7H07HFE,J03HFE38C206H07HFC,J01HFEH0EH0EH03HF8,K0HFE01FH063C3HF,K03FE03F8063E3FC,K01MF7JF8,L07PFE,L01PF8,M07NFE,M01NF8,N03LFC,O03JFC,Q07E,"
L"^FO490,170^FR^XGON7PCSKH,1,1^FS"
L"^FO010,350^A0,20,20^FDASSEMBLED IN KOREA FROM WAFER FABRICATED IN KOREA^FS"
L"^FO253,265^A0,16,16^FDAdditional information^FS"
L"^FO253,280^B7N,5,2,6,1,N^FDSK hynix            H9CKNNN8KTARKR-NTH            KR_KR     958    1524   T3LCZ80A 1S1        005  ^FS"
L"^XZ^PQ",
//30
	L"^XA^LH0,0^PO^FS"
L"^BY1,2:1,60 ^FS"
L"^FO010,040^BCN,60,N,N,N,^FDSP4E8G0XGP-L040^FS"
L"^FO010,110^A0,40,30^FDDVC : SP4E8G0XGP-L040^FS"
L"^FO010,160^BCN,60,N,N,N,^FDT3LCZ80A 1S1 005^FS"
L"^FO390,160^BCN,60,N,N,N,^FD 958^FS"
L"^FO010,230^A0,40,30^FDBOX ID : T3LCZ80A 1S1 005^FS"
L"^FO0400,230^A0,40,30^FDQ'TY : 958^FS"
L"^FO120,280^BCN,60,N,N,N,^FDT3LCZ80A 1S1 0050958^FS"
L"^FO160,350^A0,20,20^FDT3LCZ80A 1S1 0050958^FS"
L"^XZ^PQ",
//31
	L"^XA^LH0,0^PO^FS"
L"^BY1,2:1,60 ^FS"
L"^FO010,040^BCN,60,N,N,N,^FDSP4E8G0XGP-L040^FS"
L"^FO010,110^A0,40,30^FDDVC : SP4E8G0XGP-L040^FS"
L"^FO010,160^BCN,60,N,N,N,^FDT3LCZ80A 1S1 005^FS"
L"^FO390,160^BCN,60,N,N,N,^FD 958^FS"
L"^FO010,230^A0,40,30^FDBOX ID : T3LCZ80A 1S1 005^FS"
L"^FO0400,230^A0,40,30^FDQ'TY : 958^FS"
L"^FO120,280^BCN,60,N,N,N,^FDT3LCZ80A 1S1 0050958^FS"
L"^FO160,350^A0,20,20^FDT3LCZ80A 1S1 0050958^FS"
L"^XZ^PQ",
//32
	 L"^XA^LH0,0^PO^FS"
L"^FO010,010^A0,30,25^FD--------------------^FS"
L"^FO010,060^A0,30,30^FD SUPPLIER:SK hynix^FS"
L"^FO010,90^A0,30,30^FD DEVICE     :H9CKNNN8KTARKR-NTH^FS"
L"^FO010,120^A0,35,35^FD LOT NO. :T3LCZ80A -1S1( 5 / 5 )^FS"
L"^FO010,240^A0,30,30^FD DATE CODE:1524^FS"
L"^FO310,240^A0,30,30^FD Q'TY: 958 EA^FS"
L"^BY2,2.5:1,60 ^FS"
L"^FO035,160^B3,N,40,Y,N,^FDT3LCZ80A 1S1 005^FS"
L"^XZ^PQ",

////////////////////////////////////////////////////////33~52(T3LCZ88D)
//33
	L"^FX Precompiled file for C:\\Program Files\\Miracom Inc\\MESPlus\\HALOGEN_PKT.BMP width (pixels)=142 height (pixels)=47^FS"
L"^FX Scale factors: xf=1.001 yf=0.745 orientation=0 scaled width (bytes)=18 scaled height (bits)=35^FS"
L"~DGHALOGEN_PKT,01280,020,,:3FgSFE,3FQFE0g02,::3FJFE07FIFE0g02,3FJFC03FIFE0g02,3FJFC01FIFE0g02,3FJF800FIFE0g02,3FJF8007FC7E0g02,3FJF8003E01E0g02,3FJF8003800E0S06C0J02,3FJF80K0E3E018DF0F0J06C0J02,3FJF80K0E3E018DF1F0J060K02,3FJF80K0E367D8D8187DFDF6DF79DE2,3FJF80020H0E3E7DFDF187DADF6D14BD22,3FJFC0060H0E3E6DFDF186DADB6D14B1E2,3FJFC00E0H0E366D8C3186DADB6DF4B1E2,3FJFC00E001E367D8DF1F7DADF6D14BD02,3FJFE01F001E367D8DF0F7DADF6D149DE2,3FJFE01F003E0Q0180L02,3FKF01F007E0Q0180L02,3FKF83E00FE0Q0180L02,3FKF83E01FE0g02,3FKFC1E03FE0g02,3FKFE1C07FE0g02,3FLF801FFE330180K07C0M02,3FMF8FHFE330180K07C0M02,3FQFE337D80K060N02,3800780300FHFE3F7DBEF9F7C61DF7C0I02,38006002007FFE3F0DBEF916C7DD1440I02,380040H03C3FFE337DB6D9F6C7D9F7C0I02,38FF83FC7E3FFE337DB6D906C619040J02,38E007F8FF1FFE336DBEF906C619040J02,38E007F87F1FFE337DBEF9F6C619F7C0I02,38FFC3FC7E3FFE0L080R02,380040H03C3FFE0K0F80R02,38006002007FFE0K0F80R02,3800780300FHFE0g02,3FQFE0g02,:::3FgSFE,,::::::::::::::::::"
L"^XA^LH0,0^PO^FS"
L"^FO010,030^A0,30,25^FDSUPPLIER:SK hynix^FS"
L"^PRC"
L"^FO250,010^FR^XGHALOGEN_PKT,1,1^FS"
L"^FO450,030^A0,30,30^FD^FS"
L"^FO010,060^A0,30,30^FDDEVICE     :H9CKNNN8KTARKR-NTH^FS"
L"^FO010,085^A0,35,35^FDLOT NO. :T3LCZ88D     ( 1 / 5 )^FS"
L"^BY2,2.5:1,60 ^FS"
L"^FO035,115^B3,N,40,Y,N,^FDT3LCZ88D     001^FS"
L"^FO010,180^A0,22,22^FDITEM NO :120266-069(A3-3ALSHH0F-TAI-5055)^FS"
L"^BY2,2.3:1,60 ^FS"
L"^FO035,200^B3,N,40,Y,N,^FD120266-069  960^FS"
L"^FO010,300^A0,24,24^FDDATE CODE:1524^FS"
L"^FO010,265^A0,35,35^FDQ'TY: 960 EA^FS"
L"^FO010,325^A0,24,24^FDPACK DATE:2015/06/13^FS"
L"^FX Precompiled file for C:\\PROGRA~1\\MIRACO~1\\MESPLUS\\SKHYNI~4.BMP width (pixels)=92 height (pixels)=92^FS"
L"^FX Scale factors: xf=1.001 yf=1.001 orientation=0 scaled width (bytes)=12 scaled height (bits)=92^FS"
L"~DGON7PCSKH,1104,12,,O03JFC,N03LFC,N0NF,M07NFE,L01PF8,L07PFE,L0RF8,K03JF1MFC,K07JF1NF,J01KF1NF8,J03KFH0E3KFC,J07HF3HFH0638JFE,J0HFE3HF08731DJF,I01HFC3HF0C7H1C7IF8,I03FEC7HF8C70381IFC,I07F8C7HF8C703807HFE,I0HF841HF8C7070C78HF,H01HFCH07F8CF8F1C7CHF8,H01HFCH01JF0E1876HFC,H03HFE0C0IFC1F38E3HFC,H07FBE0E3IFC3HF0C3HFE,H0FE1F0OF187IF,H0FC3F87NFD8F3HF,01F8E187HFEH07IF0F1HF8001F980DIFJ07HF1F1HF8003F8H0IF8J01IFC3HFC003F808IFL0HFEH07FC007F838HFCL03HFH03FE007FCF9HF8L01HFE07FE007HFC1HFN0HFE3IF00IF83FEN07FE3IF00IF87FCN03FE7IF01LF8N01HF7IF81LF8O0LF81LFP0LF81KFEP07KF83KFEP07KFC3KFCP03KFC::3KFC01C03C07801KFC3KF801C0FE0FC01KFC3KF80360C318601KFC3KF80361803I01KFC3KF80H21803I01KFE7KF80631803I01KFE:3KF80HF98230401KFE3KF80HF8C318601KFC3KF80C18FE1FC01KFC3KF8180C7C07801KFC3KF8P01KFC3KFCP03KFC::3KFEP07KFC1KFEP07KF81LFP0LF8:1LF8N01LF80LFCN03LF00LFEN07LF00MFN0MF007LF8L01LFE007LFCL03LFE003LFEL07LFC003MF8J01MFC001MFEJ07MF8001NFCH03NF80H0gF,:H07XFE,H03XFC,:H01JFE01F01FC1KF8,I0JFE01EH0F81KF,I07IFE30E18780JFE,I03IFE38C3C780JFC,I01IFE38C7C708JF8,J0IFE38C7C7087IF,J07HFE38C2C7H07HFE,J03HFE38C206H07HFC,J01HFEH0EH0EH03HF8,K0HFE01FH063C3HF,K03FE03F8063E3FC,K01MF7JF8,L07PFE,L01PF8,M07NFE,M01NF8,N03LFC,O03JFC,Q07E,"
L"^FO490,170^FR^XGON7PCSKH,1,1^FS"
L"^FO010,350^A0,20,20^FDASSEMBLED IN KOREA FROM WAFER FABRICATED IN KOREA^FS"
L"^FO253,265^A0,16,16^FDAdditional information^FS"
L"^FO253,280^B7N,5,2,6,1,N^FDSK hynix            H9CKNNN8KTARKR-NTH            KR_KR     960    1524   T3LCZ88D            001  ^FS"
L"^XZ^PQ",
//34
	L"^XA^LH0,0^PO^FS"
L"^BY1,2:1,60 ^FS"
L"^FO010,040^BCN,60,N,N,N,^FDSP4E8G0XGP-L040^FS"
L"^FO010,110^A0,40,30^FDDVC : SP4E8G0XGP-L040^FS"
L"^FO010,160^BCN,60,N,N,N,^FDT3LCZ88D     001^FS"
L"^FO390,160^BCN,60,N,N,N,^FD 960^FS"
L"^FO010,230^A0,40,30^FDBOX ID : T3LCZ88D     001^FS"
L"^FO0400,230^A0,40,30^FDQ'TY : 960^FS"
L"^FO120,280^BCN,60,N,N,N,^FDT3LCZ88D     0010960^FS"
L"^FO160,350^A0,20,20^FDT3LCZ88D     0010960^FS"
L"^XZ^PQ",
//35
	L"^XA^LH0,0^PO^FS"
L"^BY1,2:1,60 ^FS"
L"^FO010,040^BCN,60,N,N,N,^FDSP4E8G0XGP-L040^FS"
L"^FO010,110^A0,40,30^FDDVC : SP4E8G0XGP-L040^FS"
L"^FO010,160^BCN,60,N,N,N,^FDT3LCZ88D     001^FS"
L"^FO390,160^BCN,60,N,N,N,^FD 960^FS"
L"^FO010,230^A0,40,30^FDBOX ID : T3LCZ88D     001^FS"
L"^FO0400,230^A0,40,30^FDQ'TY : 960^FS"
L"^FO120,280^BCN,60,N,N,N,^FDT3LCZ88D     0010960^FS"
L"^FO160,350^A0,20,20^FDT3LCZ88D     0010960^FS"
L"^XZ^PQ",
//36
	L"^XA^LH0,0^PO^FS"
L"^FO010,010^A0,30,25^FD--------------------^FS"
L"^FO010,060^A0,30,30^FD SUPPLIER:SK hynix^FS"
L"^FO010,90^A0,30,30^FD DEVICE     :H9CKNNN8KTARKR-NTH^FS"
L"^FO010,120^A0,35,35^FD LOT NO. :T3LCZ88D     ( 1 / 5 )^FS"
L"^FO010,240^A0,30,30^FD DATE CODE:1524^FS"
L"^FO310,240^A0,30,30^FD Q'TY: 960 EA^FS"
L"^BY2,2.5:1,60 ^FS"
L"^FO035,160^B3,N,40,Y,N,^FDT3LCZ88D     001^FS"
L"^XZ^PQ",
//37
	L">>>>>>>>>>^FX Precompiled file for C:\\Program Files\\Miracom Inc\\MESPlus\\HALOGEN_PKT.BMP width (pixels)=142 height (pixels)=47^FS"
L"^FX Scale factors: xf=1.001 yf=0.745 orientation=0 scaled width (bytes)=18 scaled height (bits)=35^FS"
L"~DGHALOGEN_PKT,01280,020,,:3FgSFE,3FQFE0g02,::3FJFE07FIFE0g02,3FJFC03FIFE0g02,3FJFC01FIFE0g02,3FJF800FIFE0g02,3FJF8007FC7E0g02,3FJF8003E01E0g02,3FJF8003800E0S06C0J02,3FJF80K0E3E018DF0F0J06C0J02,3FJF80K0E3E018DF1F0J060K02,3FJF80K0E367D8D8187DFDF6DF79DE2,3FJF80020H0E3E7DFDF187DADF6D14BD22,3FJFC0060H0E3E6DFDF186DADB6D14B1E2,3FJFC00E0H0E366D8C3186DADB6DF4B1E2,3FJFC00E001E367D8DF1F7DADF6D14BD02,3FJFE01F001E367D8DF0F7DADF6D149DE2,3FJFE01F003E0Q0180L02,3FKF01F007E0Q0180L02,3FKF83E00FE0Q0180L02,3FKF83E01FE0g02,3FKFC1E03FE0g02,3FKFE1C07FE0g02,3FLF801FFE330180K07C0M02,3FMF8FHFE330180K07C0M02,3FQFE337D80K060N02,3800780300FHFE3F7DBEF9F7C61DF7C0I02,38006002007FFE3F0DBEF916C7DD1440I02,380040H03C3FFE337DB6D9F6C7D9F7C0I02,38FF83FC7E3FFE337DB6D906C619040J02,38E007F8FF1FFE336DBEF906C619040J02,38E007F87F1FFE337DBEF9F6C619F7C0I02,38FFC3FC7E3FFE0L080R02,380040H03C3FFE0K0F80R02,38006002007FFE0K0F80R02,3800780300FHFE0g02,3FQFE0g02,:::3FgSFE,,::::::::::::::::::"
L"^XA^LH0,0^PO^FS"
L"^FO010,030^A0,30,25^FDSUPPLIER:SK hynix^FS"
L"^PRC"
L"^FO250,010^FR^XGHALOGEN_PKT,1,1^FS"
L"^FO450,030^A0,30,30^FD^FS"
L"^FO010,060^A0,30,30^FDDEVICE     :H9CKNNN8KTARKR-NTH^FS"
L"^FO010,085^A0,35,35^FDLOT NO. :T3LCZ88D     ( 2 / 5 )^FS"
L"^BY2,2.5:1,60 ^FS"
L"^FO035,115^B3,N,40,Y,N,^FDT3LCZ88D     002^FS"
L"^FO010,180^A0,22,22^FDITEM NO :120266-069(A3-3ALSHH0F-TAI-5055)^FS"
L"^BY2,2.3:1,60 ^FS"
L"^FO035,200^B3,N,40,Y,N,^FD120266-069  960^FS"
L"^FO010,300^A0,24,24^FDDATE CODE:1524^FS"
L"^FO010,265^A0,35,35^FDQ'TY: 960 EA^FS"
L"^FO010,325^A0,24,24^FDPACK DATE:2015/06/13^FS"
L"^FX Precompiled file for C:\\PROGRA~1\\MIRACO~1\\MESPLUS\\SKHYNI~4.BMP width (pixels)=92 height (pixels)=92^FS"
L"^FX Scale factors: xf=1.001 yf=1.001 orientation=0 scaled width (bytes)=12 scaled height (bits)=92^FS"
L"~DGON7PCSKH,1104,12,,O03JFC,N03LFC,N0NF,M07NFE,L01PF8,L07PFE,L0RF8,K03JF1MFC,K07JF1NF,J01KF1NF8,J03KFH0E3KFC,J07HF3HFH0638JFE,J0HFE3HF08731DJF,I01HFC3HF0C7H1C7IF8,I03FEC7HF8C70381IFC,I07F8C7HF8C703807HFE,I0HF841HF8C7070C78HF,H01HFCH07F8CF8F1C7CHF8,H01HFCH01JF0E1876HFC,H03HFE0C0IFC1F38E3HFC,H07FBE0E3IFC3HF0C3HFE,H0FE1F0OF187IF,H0FC3F87NFD8F3HF,01F8E187HFEH07IF0F1HF8001F980DIFJ07HF1F1HF8003F8H0IF8J01IFC3HFC003F808IFL0HFEH07FC007F838HFCL03HFH03FE007FCF9HF8L01HFE07FE007HFC1HFN0HFE3IF00IF83FEN07FE3IF00IF87FCN03FE7IF01LF8N01HF7IF81LF8O0LF81LFP0LF81KFEP07KF83KFEP07KFC3KFCP03KFC::3KFC01C03C07801KFC3KF801C0FE0FC01KFC3KF80360C318601KFC3KF80361803I01KFC3KF80H21803I01KFE7KF80631803I01KFE:3KF80HF98230401KFE3KF80HF8C318601KFC3KF80C18FE1FC01KFC3KF8180C7C07801KFC3KF8P01KFC3KFCP03KFC::3KFEP07KFC1KFEP07KF81LFP0LF8:1LF8N01LF80LFCN03LF00LFEN07LF00MFN0MF007LF8L01LFE007LFCL03LFE003LFEL07LFC003MF8J01MFC001MFEJ07MF8001NFCH03NF80H0gF,:H07XFE,H03XFC,:H01JFE01F01FC1KF8,I0JFE01EH0F81KF,I07IFE30E18780JFE,I03IFE38C3C780JFC,I01IFE38C7C708JF8,J0IFE38C7C7087IF,J07HFE38C2C7H07HFE,J03HFE38C206H07HFC,J01HFEH0EH0EH03HF8,K0HFE01FH063C3HF,K03FE03F8063E3FC,K01MF7JF8,L07PFE,L01PF8,M07NFE,M01NF8,N03LFC,O03JFC,Q07E,"
L"^FO490,170^FR^XGON7PCSKH,1,1^FS"
L"^FO010,350^A0,20,20^FDASSEMBLED IN KOREA FROM WAFER FABRICATED IN KOREA^FS"
L"^FO253,265^A0,16,16^FDAdditional information^FS"
L"^FO253,280^B7N,5,2,6,1,N^FDSK hynix            H9CKNNN8KTARKR-NTH            KR_KR     960    1524   T3LCZ88D            002  ^FS"
L"^XZ^PQ",
//38
	L"^XA^LH0,0^PO^FS"
L"^BY1,2:1,60 ^FS"
L"^FO010,040^BCN,60,N,N,N,^FDSP4E8G0XGP-L040^FS"
L"^FO010,110^A0,40,30^FDDVC : SP4E8G0XGP-L040^FS"
L"^FO010,160^BCN,60,N,N,N,^FDT3LCZ88D     002^FS"
L"^FO390,160^BCN,60,N,N,N,^FD 960^FS"
L"^FO010,230^A0,40,30^FDBOX ID : T3LCZ88D     002^FS"
L"^FO0400,230^A0,40,30^FDQ'TY : 960^FS"
L"^FO120,280^BCN,60,N,N,N,^FDT3LCZ88D     0020960^FS"
L"^FO160,350^A0,20,20^FDT3LCZ88D     0020960^FS"
L"^XZ^PQ",
//39
	L"^XA^LH0,0^PO^FS"
L"^BY1,2:1,60 ^FS"
L"^FO010,040^BCN,60,N,N,N,^FDSP4E8G0XGP-L040^FS"
L"^FO010,110^A0,40,30^FDDVC : SP4E8G0XGP-L040^FS"
L"^FO010,160^BCN,60,N,N,N,^FDT3LCZ88D     002^FS"
L"^FO390,160^BCN,60,N,N,N,^FD 960^FS"
L"^FO010,230^A0,40,30^FDBOX ID : T3LCZ88D     002^FS"
L"^FO0400,230^A0,40,30^FDQ'TY : 960^FS"
L"^FO120,280^BCN,60,N,N,N,^FDT3LCZ88D     0020960^FS"
L"^FO160,350^A0,20,20^FDT3LCZ88D     0020960^FS"
L"^XZ^PQ",
//40
	L"^XA^LH0,0^PO^FS"
L"^FO010,010^A0,30,25^FD--------------------^FS"
L"^FO010,060^A0,30,30^FD SUPPLIER:SK hynix^FS"
L"^FO010,90^A0,30,30^FD DEVICE     :H9CKNNN8KTARKR-NTH^FS"
L"^FO010,120^A0,35,35^FD LOT NO. :T3LCZ88D     ( 2 / 5 )^FS"
L"^FO010,240^A0,30,30^FD DATE CODE:1524^FS"
L"^FO310,240^A0,30,30^FD Q'TY: 960 EA^FS"
L"^BY2,2.5:1,60 ^FS"
L"^FO035,160^B3,N,40,Y,N,^FDT3LCZ88D     002^FS"
L"^XZ^PQ",
//41
	L">>>>>>>>>>^FX Precompiled file for C:\\Program Files\\Miracom Inc\\MESPlus\\HALOGEN_PKT.BMP width (pixels)=142 height (pixels)=47^FS"
L"^FX Scale factors: xf=1.001 yf=0.745 orientation=0 scaled width (bytes)=18 scaled height (bits)=35^FS"
L"~DGHALOGEN_PKT,01280,020,,:3FgSFE,3FQFE0g02,::3FJFE07FIFE0g02,3FJFC03FIFE0g02,3FJFC01FIFE0g02,3FJF800FIFE0g02,3FJF8007FC7E0g02,3FJF8003E01E0g02,3FJF8003800E0S06C0J02,3FJF80K0E3E018DF0F0J06C0J02,3FJF80K0E3E018DF1F0J060K02,3FJF80K0E367D8D8187DFDF6DF79DE2,3FJF80020H0E3E7DFDF187DADF6D14BD22,3FJFC0060H0E3E6DFDF186DADB6D14B1E2,3FJFC00E0H0E366D8C3186DADB6DF4B1E2,3FJFC00E001E367D8DF1F7DADF6D14BD02,3FJFE01F001E367D8DF0F7DADF6D149DE2,3FJFE01F003E0Q0180L02,3FKF01F007E0Q0180L02,3FKF83E00FE0Q0180L02,3FKF83E01FE0g02,3FKFC1E03FE0g02,3FKFE1C07FE0g02,3FLF801FFE330180K07C0M02,3FMF8FHFE330180K07C0M02,3FQFE337D80K060N02,3800780300FHFE3F7DBEF9F7C61DF7C0I02,38006002007FFE3F0DBEF916C7DD1440I02,380040H03C3FFE337DB6D9F6C7D9F7C0I02,38FF83FC7E3FFE337DB6D906C619040J02,38E007F8FF1FFE336DBEF906C619040J02,38E007F87F1FFE337DBEF9F6C619F7C0I02,38FFC3FC7E3FFE0L080R02,380040H03C3FFE0K0F80R02,38006002007FFE0K0F80R02,3800780300FHFE0g02,3FQFE0g02,:::3FgSFE,,::::::::::::::::::"
L"^XA^LH0,0^PO^FS"
L"^FO010,030^A0,30,25^FDSUPPLIER:SK hynix^FS"
L"^PRC"
L"^FO250,010^FR^XGHALOGEN_PKT,1,1^FS"
L"^FO450,030^A0,30,30^FD^FS"
L"^FO010,060^A0,30,30^FDDEVICE     :H9CKNNN8KTARKR-NTH^FS"
L"^FO010,085^A0,35,35^FDLOT NO. :T3LCZ88D     ( 3 / 5 )^FS"
L"^BY2,2.5:1,60 ^FS"
L"^FO035,115^B3,N,40,Y,N,^FDT3LCZ88D     003^FS"
L"^FO010,180^A0,22,22^FDITEM NO :120266-069(A3-3ALSHH0F-TAI-5055)^FS"
L"^BY2,2.3:1,60 ^FS"
L"^FO035,200^B3,N,40,Y,N,^FD120266-069  960^FS"
L"^FO010,300^A0,24,24^FDDATE CODE:1524^FS"
L"^FO010,265^A0,35,35^FDQ'TY: 960 EA^FS"
L"^FO010,325^A0,24,24^FDPACK DATE:2015/06/13^FS"
L"^FX Precompiled file for C:\\PROGRA~1\\MIRACO~1\\MESPLUS\\SKHYNI~4.BMP width (pixels)=92 height (pixels)=92^FS"
L"^FX Scale factors: xf=1.001 yf=1.001 orientation=0 scaled width (bytes)=12 scaled height (bits)=92^FS"
L"~DGON7PCSKH,1104,12,,O03JFC,N03LFC,N0NF,M07NFE,L01PF8,L07PFE,L0RF8,K03JF1MFC,K07JF1NF,J01KF1NF8,J03KFH0E3KFC,J07HF3HFH0638JFE,J0HFE3HF08731DJF,I01HFC3HF0C7H1C7IF8,I03FEC7HF8C70381IFC,I07F8C7HF8C703807HFE,I0HF841HF8C7070C78HF,H01HFCH07F8CF8F1C7CHF8,H01HFCH01JF0E1876HFC,H03HFE0C0IFC1F38E3HFC,H07FBE0E3IFC3HF0C3HFE,H0FE1F0OF187IF,H0FC3F87NFD8F3HF,01F8E187HFEH07IF0F1HF8001F980DIFJ07HF1F1HF8003F8H0IF8J01IFC3HFC003F808IFL0HFEH07FC007F838HFCL03HFH03FE007FCF9HF8L01HFE07FE007HFC1HFN0HFE3IF00IF83FEN07FE3IF00IF87FCN03FE7IF01LF8N01HF7IF81LF8O0LF81LFP0LF81KFEP07KF83KFEP07KFC3KFCP03KFC::3KFC01C03C07801KFC3KF801C0FE0FC01KFC3KF80360C318601KFC3KF80361803I01KFC3KF80H21803I01KFE7KF80631803I01KFE:3KF80HF98230401KFE3KF80HF8C318601KFC3KF80C18FE1FC01KFC3KF8180C7C07801KFC3KF8P01KFC3KFCP03KFC::3KFEP07KFC1KFEP07KF81LFP0LF8:1LF8N01LF80LFCN03LF00LFEN07LF00MFN0MF007LF8L01LFE007LFCL03LFE003LFEL07LFC003MF8J01MFC001MFEJ07MF8001NFCH03NF80H0gF,:H07XFE,H03XFC,:H01JFE01F01FC1KF8,I0JFE01EH0F81KF,I07IFE30E18780JFE,I03IFE38C3C780JFC,I01IFE38C7C708JF8,J0IFE38C7C7087IF,J07HFE38C2C7H07HFE,J03HFE38C206H07HFC,J01HFEH0EH0EH03HF8,K0HFE01FH063C3HF,K03FE03F8063E3FC,K01MF7JF8,L07PFE,L01PF8,M07NFE,M01NF8,N03LFC,O03JFC,Q07E,"
L"^FO490,170^FR^XGON7PCSKH,1,1^FS"
L"^FO010,350^A0,20,20^FDASSEMBLED IN KOREA FROM WAFER FABRICATED IN KOREA^FS"
L"^FO253,265^A0,16,16^FDAdditional information^FS"
L"^FO253,280^B7N,5,2,6,1,N^FDSK hynix            H9CKNNN8KTARKR-NTH            KR_KR     960    1524   T3LCZ88D            003  ^FS"
L"^XZ^PQ",
//42
	 L"^XA^LH0,0^PO^FS"
L"^BY1,2:1,60 ^FS"
L"^FO010,040^BCN,60,N,N,N,^FDSP4E8G0XGP-L040^FS"
L"^FO010,110^A0,40,30^FDDVC : SP4E8G0XGP-L040^FS"
L"^FO010,160^BCN,60,N,N,N,^FDT3LCZ88D     003^FS"
L"^FO390,160^BCN,60,N,N,N,^FD 960^FS"
L"^FO010,230^A0,40,30^FDBOX ID : T3LCZ88D     003^FS"
L"^FO0400,230^A0,40,30^FDQ'TY : 960^FS"
L"^FO120,280^BCN,60,N,N,N,^FDT3LCZ88D     0030960^FS"
L"^FO160,350^A0,20,20^FDT3LCZ88D     0030960^FS"
L"^XZ^PQ",
//43
	L"^XA^LH0,0^PO^FS"
L"^BY1,2:1,60 ^FS"
L"^FO010,040^BCN,60,N,N,N,^FDSP4E8G0XGP-L040^FS"
L"^FO010,110^A0,40,30^FDDVC : SP4E8G0XGP-L040^FS"
L"^FO010,160^BCN,60,N,N,N,^FDT3LCZ88D     003^FS"
L"^FO390,160^BCN,60,N,N,N,^FD 960^FS"
L"^FO010,230^A0,40,30^FDBOX ID : T3LCZ88D     003^FS"
L"^FO0400,230^A0,40,30^FDQ'TY : 960^FS"
L"^FO120,280^BCN,60,N,N,N,^FDT3LCZ88D     0030960^FS"
L"^FO160,350^A0,20,20^FDT3LCZ88D     0030960^FS"
L"^XZ^PQ",
//44
	L"^XA^LH0,0^PO^FS"
L"^FO010,010^A0,30,25^FD--------------------^FS"
L"^FO010,060^A0,30,30^FD SUPPLIER:SK hynix^FS"
L"^FO010,90^A0,30,30^FD DEVICE     :H9CKNNN8KTARKR-NTH^FS"
L"^FO010,120^A0,35,35^FD LOT NO. :T3LCZ88D     ( 3 / 5 )^FS"
L"^FO010,240^A0,30,30^FD DATE CODE:1524^FS"
L"^FO310,240^A0,30,30^FD Q'TY: 960 EA^FS"
L"^BY2,2.5:1,60 ^FS"
L"^FO035,160^B3,N,40,Y,N,^FDT3LCZ88D     003^FS"
L"^XZ^PQ",
//45
	L">>>>>>>>>>^FX Precompiled file for C:\\Program Files\\Miracom Inc\\MESPlus\\HALOGEN_PKT.BMP width (pixels)=142 height (pixels)=47^FS"
L"^FX Scale factors: xf=1.001 yf=0.745 orientation=0 scaled width (bytes)=18 scaled height (bits)=35^FS"
L"~DGHALOGEN_PKT,01280,020,,:3FgSFE,3FQFE0g02,::3FJFE07FIFE0g02,3FJFC03FIFE0g02,3FJFC01FIFE0g02,3FJF800FIFE0g02,3FJF8007FC7E0g02,3FJF8003E01E0g02,3FJF8003800E0S06C0J02,3FJF80K0E3E018DF0F0J06C0J02,3FJF80K0E3E018DF1F0J060K02,3FJF80K0E367D8D8187DFDF6DF79DE2,3FJF80020H0E3E7DFDF187DADF6D14BD22,3FJFC0060H0E3E6DFDF186DADB6D14B1E2,3FJFC00E0H0E366D8C3186DADB6DF4B1E2,3FJFC00E001E367D8DF1F7DADF6D14BD02,3FJFE01F001E367D8DF0F7DADF6D149DE2,3FJFE01F003E0Q0180L02,3FKF01F007E0Q0180L02,3FKF83E00FE0Q0180L02,3FKF83E01FE0g02,3FKFC1E03FE0g02,3FKFE1C07FE0g02,3FLF801FFE330180K07C0M02,3FMF8FHFE330180K07C0M02,3FQFE337D80K060N02,3800780300FHFE3F7DBEF9F7C61DF7C0I02,38006002007FFE3F0DBEF916C7DD1440I02,380040H03C3FFE337DB6D9F6C7D9F7C0I02,38FF83FC7E3FFE337DB6D906C619040J02,38E007F8FF1FFE336DBEF906C619040J02,38E007F87F1FFE337DBEF9F6C619F7C0I02,38FFC3FC7E3FFE0L080R02,380040H03C3FFE0K0F80R02,38006002007FFE0K0F80R02,3800780300FHFE0g02,3FQFE0g02,:::3FgSFE,,::::::::::::::::::"
L"^XA^LH0,0^PO^FS"
L"^FO010,030^A0,30,25^FDSUPPLIER:SK hynix^FS"
L"^PRC"
L"^FO250,010^FR^XGHALOGEN_PKT,1,1^FS"
L"^FO450,030^A0,30,30^FD^FS"
L"^FO010,060^A0,30,30^FDDEVICE     :H9CKNNN8KTARKR-NTH^FS"
L"^FO010,085^A0,35,35^FDLOT NO. :T3LCZ88D     ( 4 / 5 )^FS"
L"^BY2,2.5:1,60 ^FS"
L"^FO035,115^B3,N,40,Y,N,^FDT3LCZ88D     004^FS"
L"^FO010,180^A0,22,22^FDITEM NO :120266-069(A3-3ALSHH0F-TAI-5055)^FS"
L"^BY2,2.3:1,60 ^FS"
L"^FO035,200^B3,N,40,Y,N,^FD120266-069  960^FS"
L"^FO010,300^A0,24,24^FDDATE CODE:1524^FS"
L"^FO010,265^A0,35,35^FDQ'TY: 960 EA^FS"
L"^FO010,325^A0,24,24^FDPACK DATE:2015/06/13^FS"
L"^FX Precompiled file for C:\\PROGRA~1\\MIRACO~1\\MESPLUS\\SKHYNI~4.BMP width (pixels)=92 height (pixels)=92^FS"
L"^FX Scale factors: xf=1.001 yf=1.001 orientation=0 scaled width (bytes)=12 scaled height (bits)=92^FS"
L"~DGON7PCSKH,1104,12,,O03JFC,N03LFC,N0NF,M07NFE,L01PF8,L07PFE,L0RF8,K03JF1MFC,K07JF1NF,J01KF1NF8,J03KFH0E3KFC,J07HF3HFH0638JFE,J0HFE3HF08731DJF,I01HFC3HF0C7H1C7IF8,I03FEC7HF8C70381IFC,I07F8C7HF8C703807HFE,I0HF841HF8C7070C78HF,H01HFCH07F8CF8F1C7CHF8,H01HFCH01JF0E1876HFC,H03HFE0C0IFC1F38E3HFC,H07FBE0E3IFC3HF0C3HFE,H0FE1F0OF187IF,H0FC3F87NFD8F3HF,01F8E187HFEH07IF0F1HF8001F980DIFJ07HF1F1HF8003F8H0IF8J01IFC3HFC003F808IFL0HFEH07FC007F838HFCL03HFH03FE007FCF9HF8L01HFE07FE007HFC1HFN0HFE3IF00IF83FEN07FE3IF00IF87FCN03FE7IF01LF8N01HF7IF81LF8O0LF81LFP0LF81KFEP07KF83KFEP07KFC3KFCP03KFC::3KFC01C03C07801KFC3KF801C0FE0FC01KFC3KF80360C318601KFC3KF80361803I01KFC3KF80H21803I01KFE7KF80631803I01KFE:3KF80HF98230401KFE3KF80HF8C318601KFC3KF80C18FE1FC01KFC3KF8180C7C07801KFC3KF8P01KFC3KFCP03KFC::3KFEP07KFC1KFEP07KF81LFP0LF8:1LF8N01LF80LFCN03LF00LFEN07LF00MFN0MF007LF8L01LFE007LFCL03LFE003LFEL07LFC003MF8J01MFC001MFEJ07MF8001NFCH03NF80H0gF,:H07XFE,H03XFC,:H01JFE01F01FC1KF8,I0JFE01EH0F81KF,I07IFE30E18780JFE,I03IFE38C3C780JFC,I01IFE38C7C708JF8,J0IFE38C7C7087IF,J07HFE38C2C7H07HFE,J03HFE38C206H07HFC,J01HFEH0EH0EH03HF8,K0HFE01FH063C3HF,K03FE03F8063E3FC,K01MF7JF8,L07PFE,L01PF8,M07NFE,M01NF8,N03LFC,O03JFC,Q07E,"
L"^FO490,170^FR^XGON7PCSKH,1,1^FS"
L"^FO010,350^A0,20,20^FDASSEMBLED IN KOREA FROM WAFER FABRICATED IN KOREA^FS"
L"^FO253,265^A0,16,16^FDAdditional information^FS"
L"^FO253,280^B7N,5,2,6,1,N^FDSK hynix            H9CKNNN8KTARKR-NTH            KR_KR     960    1524   T3LCZ88D            004  ^FS"
L"^XZ^PQ",
//46
	L"^XA^LH0,0^PO^FS"
L"^BY1,2:1,60 ^FS"
L"^FO010,040^BCN,60,N,N,N,^FDSP4E8G0XGP-L040^FS"
L"^FO010,110^A0,40,30^FDDVC : SP4E8G0XGP-L040^FS"
L"^FO010,160^BCN,60,N,N,N,^FDT3LCZ88D     004^FS"
L"^FO390,160^BCN,60,N,N,N,^FD 960^FS"
L"^FO010,230^A0,40,30^FDBOX ID : T3LCZ88D     004^FS"
L"^FO0400,230^A0,40,30^FDQ'TY : 960^FS"
L"^FO120,280^BCN,60,N,N,N,^FDT3LCZ88D     0040960^FS"
L"^FO160,350^A0,20,20^FDT3LCZ88D     0040960^FS"
L"^XZ^PQ",
//47
	L"^XA^LH0,0^PO^FS"
L"^BY1,2:1,60 ^FS"
L"^FO010,040^BCN,60,N,N,N,^FDSP4E8G0XGP-L040^FS"
L"^FO010,110^A0,40,30^FDDVC : SP4E8G0XGP-L040^FS"
L"^FO010,160^BCN,60,N,N,N,^FDT3LCZ88D     004^FS"
L"^FO390,160^BCN,60,N,N,N,^FD 960^FS"
L"^FO010,230^A0,40,30^FDBOX ID : T3LCZ88D     004^FS"
L"^FO0400,230^A0,40,30^FDQ'TY : 960^FS"
L"^FO120,280^BCN,60,N,N,N,^FDT3LCZ88D     0040960^FS"
L"^FO160,350^A0,20,20^FDT3LCZ88D     0040960^FS"
L"^XZ^PQ",
//48
	L"^XA^LH0,0^PO^FS"
L"^FO010,010^A0,30,25^FD--------------------^FS"
L"^FO010,060^A0,30,30^FD SUPPLIER:SK hynix^FS"
L"^FO010,90^A0,30,30^FD DEVICE     :H9CKNNN8KTARKR-NTH^FS"
L"^FO010,120^A0,35,35^FD LOT NO. :T3LCZ88D     ( 4 / 5 )^FS"
L"^FO010,240^A0,30,30^FD DATE CODE:1524^FS"
L"^FO310,240^A0,30,30^FD Q'TY: 960 EA^FS"
L"^BY2,2.5:1,60 ^FS"
L"^FO035,160^B3,N,40,Y,N,^FDT3LCZ88D     004^FS"
L"^XZ^PQ",
//49
	L">>>>>>>>>>^FX Precompiled file for C:\\Program Files\\Miracom Inc\\MESPlus\\HALOGEN_PKT.BMP width (pixels)=142 height (pixels)=47^FS"
L"^FX Scale factors: xf=1.001 yf=0.745 orientation=0 scaled width (bytes)=18 scaled height (bits)=35^FS"
L"~DGHALOGEN_PKT,01280,020,,:3FgSFE,3FQFE0g02,::3FJFE07FIFE0g02,3FJFC03FIFE0g02,3FJFC01FIFE0g02,3FJF800FIFE0g02,3FJF8007FC7E0g02,3FJF8003E01E0g02,3FJF8003800E0S06C0J02,3FJF80K0E3E018DF0F0J06C0J02,3FJF80K0E3E018DF1F0J060K02,3FJF80K0E367D8D8187DFDF6DF79DE2,3FJF80020H0E3E7DFDF187DADF6D14BD22,3FJFC0060H0E3E6DFDF186DADB6D14B1E2,3FJFC00E0H0E366D8C3186DADB6DF4B1E2,3FJFC00E001E367D8DF1F7DADF6D14BD02,3FJFE01F001E367D8DF0F7DADF6D149DE2,3FJFE01F003E0Q0180L02,3FKF01F007E0Q0180L02,3FKF83E00FE0Q0180L02,3FKF83E01FE0g02,3FKFC1E03FE0g02,3FKFE1C07FE0g02,3FLF801FFE330180K07C0M02,3FMF8FHFE330180K07C0M02,3FQFE337D80K060N02,3800780300FHFE3F7DBEF9F7C61DF7C0I02,38006002007FFE3F0DBEF916C7DD1440I02,380040H03C3FFE337DB6D9F6C7D9F7C0I02,38FF83FC7E3FFE337DB6D906C619040J02,38E007F8FF1FFE336DBEF906C619040J02,38E007F87F1FFE337DBEF9F6C619F7C0I02,38FFC3FC7E3FFE0L080R02,380040H03C3FFE0K0F80R02,38006002007FFE0K0F80R02,3800780300FHFE0g02,3FQFE0g02,:::3FgSFE,,::::::::::::::::::"
L"^XA^LH0,0^PO^FS"
L"^FO010,030^A0,30,25^FDSUPPLIER:SK hynix^FS"
L"^PRC"
L"^FO250,010^FR^XGHALOGEN_PKT,1,1^FS"
L"^FO450,030^A0,30,30^FD^FS"
L"^FO010,060^A0,30,30^FDDEVICE     :H9CKNNN8KTARKR-NTH^FS"
L"^FO010,085^A0,35,35^FDLOT NO. :T3LCZ88D     ( 5 / 5 )^FS"
L"^BY2,2.5:1,60 ^FS"
L"^FO035,115^B3,N,40,Y,N,^FDT3LCZ88D     005^FS"
L"^FO010,180^A0,22,22^FDITEM NO :120266-069(A3-3ALSHH0F-TAI-5055)^FS"
L"^BY2,2.3:1,60 ^FS"
L"^FO035,200^B3,N,40,Y,N,^FD120266-069  919^FS"
L"^FO010,300^A0,24,24^FDDATE CODE:1524^FS"
L"^FO010,265^A0,35,35^FDQ'TY: 919 EA^FS"
L"^FO010,325^A0,24,24^FDPACK DATE:2015/06/13^FS"
L"^FX Precompiled file for C:\\PROGRA~1\\MIRACO~1\\MESPLUS\\SKHYNI~4.BMP width (pixels)=92 height (pixels)=92^FS"
L"^FX Scale factors: xf=1.001 yf=1.001 orientation=0 scaled width (bytes)=12 scaled height (bits)=92^FS"
L"~DGON7PCSKH,1104,12,,O03JFC,N03LFC,N0NF,M07NFE,L01PF8,L07PFE,L0RF8,K03JF1MFC,K07JF1NF,J01KF1NF8,J03KFH0E3KFC,J07HF3HFH0638JFE,J0HFE3HF08731DJF,I01HFC3HF0C7H1C7IF8,I03FEC7HF8C70381IFC,I07F8C7HF8C703807HFE,I0HF841HF8C7070C78HF,H01HFCH07F8CF8F1C7CHF8,H01HFCH01JF0E1876HFC,H03HFE0C0IFC1F38E3HFC,H07FBE0E3IFC3HF0C3HFE,H0FE1F0OF187IF,H0FC3F87NFD8F3HF,01F8E187HFEH07IF0F1HF8001F980DIFJ07HF1F1HF8003F8H0IF8J01IFC3HFC003F808IFL0HFEH07FC007F838HFCL03HFH03FE007FCF9HF8L01HFE07FE007HFC1HFN0HFE3IF00IF83FEN07FE3IF00IF87FCN03FE7IF01LF8N01HF7IF81LF8O0LF81LFP0LF81KFEP07KF83KFEP07KFC3KFCP03KFC::3KFC01C03C07801KFC3KF801C0FE0FC01KFC3KF80360C318601KFC3KF80361803I01KFC3KF80H21803I01KFE7KF80631803I01KFE:3KF80HF98230401KFE3KF80HF8C318601KFC3KF80C18FE1FC01KFC3KF8180C7C07801KFC3KF8P01KFC3KFCP03KFC::3KFEP07KFC1KFEP07KF81LFP0LF8:1LF8N01LF80LFCN03LF00LFEN07LF00MFN0MF007LF8L01LFE007LFCL03LFE003LFEL07LFC003MF8J01MFC001MFEJ07MF8001NFCH03NF80H0gF,:H07XFE,H03XFC,:H01JFE01F01FC1KF8,I0JFE01EH0F81KF,I07IFE30E18780JFE,I03IFE38C3C780JFC,I01IFE38C7C708JF8,J0IFE38C7C7087IF,J07HFE38C2C7H07HFE,J03HFE38C206H07HFC,J01HFEH0EH0EH03HF8,K0HFE01FH063C3HF,K03FE03F8063E3FC,K01MF7JF8,L07PFE,L01PF8,M07NFE,M01NF8,N03LFC,O03JFC,Q07E,"
L"^FO490,170^FR^XGON7PCSKH,1,1^FS"
L"^FO010,350^A0,20,20^FDASSEMBLED IN KOREA FROM WAFER FABRICATED IN KOREA^FS"
L"^FO253,265^A0,16,16^FDAdditional information^FS"
L"^FO253,280^B7N,5,2,6,1,N^FDSK hynix            H9CKNNN8KTARKR-NTH            KR_KR     919    1524   T3LCZ88D            005  ^FS"
L"^XZ^PQ",
//50
	L"^XA^LH0,0^PO^FS"
L"^BY1,2:1,60 ^FS"
L"^FO010,040^BCN,60,N,N,N,^FDSP4E8G0XGP-L040^FS"
L"^FO010,110^A0,40,30^FDDVC : SP4E8G0XGP-L040^FS"
L"^FO010,160^BCN,60,N,N,N,^FDT3LCZ88D     005^FS"
L"^FO390,160^BCN,60,N,N,N,^FD 919^FS"
L"^FO010,230^A0,40,30^FDBOX ID : T3LCZ88D     005^FS"
L"^FO0400,230^A0,40,30^FDQ'TY : 919^FS"
L"^FO120,280^BCN,60,N,N,N,^FDT3LCZ88D     0050919^FS"
L"^FO160,350^A0,20,20^FDT3LCZ88D     0050919^FS"
L"^XZ^PQ",
//51
	L"^XA^LH0,0^PO^FS"
L"^BY1,2:1,60 ^FS"
L"^FO010,040^BCN,60,N,N,N,^FDSP4E8G0XGP-L040^FS"
L"^FO010,110^A0,40,30^FDDVC : SP4E8G0XGP-L040^FS"
L"^FO010,160^BCN,60,N,N,N,^FDT3LCZ88D     005^FS"
L"^FO390,160^BCN,60,N,N,N,^FD 919^FS"
L"^FO010,230^A0,40,30^FDBOX ID : T3LCZ88D     005^FS"
L"^FO0400,230^A0,40,30^FDQ'TY : 919^FS"
L"^FO120,280^BCN,60,N,N,N,^FDT3LCZ88D     0050919^FS"
L"^FO160,350^A0,20,20^FDT3LCZ88D     0050919^FS"
L"^XZ^PQ",
//52
	L"^XA^LH0,0^PO^FS"
L"^FO010,010^A0,30,25^FD--------------------^FS"
L"^FO010,060^A0,30,30^FD SUPPLIER:SK hynix^FS"
L"^FO010,90^A0,30,30^FD DEVICE     :H9CKNNN8KTARKR-NTH^FS"
L"^FO010,120^A0,35,35^FD LOT NO. :T3LCZ88D     ( 5 / 5 )^FS"
L"^FO010,240^A0,30,30^FD DATE CODE:1524^FS"
L"^FO310,240^A0,30,30^FD Q'TY: 919 EA^FS"
L"^BY2,2.5:1,60 ^FS"
L"^FO035,160^B3,N,40,Y,N,^FDT3LCZ88D     005^FS"
L"^XZ^PQ",
};

// 응용 프로그램 정보에 사용되는 CAboutDlg 대화 상자입니다.

class CAboutDlg : public CDialogEx
{
public:
	CAboutDlg();

// 대화 상자 데이터입니다.
	enum { IDD = IDD_ABOUTBOX };

	protected:
	virtual void DoDataExchange(CDataExchange* pDX);    // DDX/DDV 지원입니다.

// 구현입니다.
protected:
	DECLARE_MESSAGE_MAP()
};

CAboutDlg::CAboutDlg() : CDialogEx(CAboutDlg::IDD)
{
}

void CAboutDlg::DoDataExchange(CDataExchange* pDX)
{
	CDialogEx::DoDataExchange(pDX);
}

BEGIN_MESSAGE_MAP(CAboutDlg, CDialogEx)
END_MESSAGE_MAP()

// CZLabelPreviewSaveDlg 대화 상자
CZLabelPreviewSaveDlg::CZLabelPreviewSaveDlg(CWnd* pParent /*=NULL*/)
	: CDialogEx(CZLabelPreviewSaveDlg::IDD, pParent)
	, m_strZPL(_T(""))
{
//2016-10-12 ClassName 등록
	WNDCLASS wc;
	GetClassInfo(AfxGetInstanceHandle(), _T("#32770"), &wc);
	wc.lpszClassName = _T("ZPL2img");
	AfxRegisterClass(&wc);
//
	m_hIcon = AfxGetApp()->LoadIcon(IDR_MAINFRAME);

	//m_strHomeUrl = _T("http://192.168.1.120/zpl%20%20"); //%20%20%20%20%20%20%20%20%20FA8C470Dost?dev=R&oname=UNKNOWN&otype=ZPL&pw=&data=");
	//m_strEndUrl = _T("http://192.168.1.120/zpl");

	//status
	m_nStatus = -1;
	m_strTitle = L"";
	m_strStatusText = L"";
	m_nProgress = -1; 
	m_nProgressMax = -1;

	m_strDMS_IP = L"";
	m_strDMS_Port = L"";
	m_strZEBRA_IP = L"";

	m_bDMSconnected = FALSE;
	
	m_nStatus = 10;

	//m_nZebraCheckTerm = 10; //2016-10-25
	m_nZebraCheckTerm = 5; //2017-08-07 default 5sec
	
	//2017-07-31 복구
	m_nImgInMemoryLimit = 300; //2017-08-07 default 300ea
	 //2017-01-16
	m_nSaveImageTerm = 3;
	//m_nDMS_ConnectTerm = 5;
	m_nDMS_ConnectTerm = 2; //2017-08-07 default 2sec
	//m_nTimeOut = 10; //2017-01-18
	m_nTimeOut = 5; //2017-08-07 default 5sec

	//2016-10-27
	m_bPauseMonitoringZEBRA = FALSE;

	//2017-01-20
	m_strNumOfImgInMemory = L"--";
//^XA^FO 80,80^AE 21,10^FD ZEBRA PRINTER^FS^XZ
	//2017-07-19
	m_nZplToDo = 0;
	m_bInImgProcess = FALSE;
	//2017-07-20
	//m_nRetryCheckTerm = 7;
	m_nRetryCheckTerm = 25; //2017-07-28 변경
	m_bZebraConnect = FALSE;
	//2017-08-07 추가
	m_bImgBreak = FALSE;
}

void CZLabelPreviewSaveDlg::DoDataExchange(CDataExchange* pDX)
{
	CDialogEx::DoDataExchange(pDX);
	DDX_Control(pDX, IDC_EXPLORER, m_IExplorer);
	DDX_Text(pDX, IDC_EDIT_ZPL, m_strZPL);
	DDX_Control(pDX, IDC_CB_ZPL, m_ctlCbZpl);
	DDX_Control(pDX, IDC_LIST_EVENT, m_ctlListEvent);
	DDX_Control(pDX, IDC_LIST_SOCKET, m_ctlListSocket);
}

BEGIN_MESSAGE_MAP(CZLabelPreviewSaveDlg, CDialogEx)
	ON_WM_SYSCOMMAND()
	ON_WM_PAINT()
	ON_WM_QUERYDRAGICON()
	ON_BN_CLICKED(IDC_BT_EXEC, &CZLabelPreviewSaveDlg::OnBnClickedBtExec)
	ON_BN_CLICKED(IDC_BT_NEW, &CZLabelPreviewSaveDlg::OnBnClickedBtNew)
	ON_WM_TIMER()
	ON_CBN_CLOSEUP(IDC_CB_ZPL, &CZLabelPreviewSaveDlg::OnCbnCloseupCbZpl)
	ON_BN_CLICKED(IDC_BT_EVENT_CLEAR, &CZLabelPreviewSaveDlg::OnBnClickedBtEventClear)
	ON_BN_CLICKED(IDC_BT_EXIT, &CZLabelPreviewSaveDlg::OnBnClickedBtExit)
	ON_BN_CLICKED(IDC_BT_CONNECT, &CZLabelPreviewSaveDlg::OnBnClickedBtConnect)
	ON_BN_CLICKED(IDC_BT_DISCONNECT, &CZLabelPreviewSaveDlg::OnBnClickedBtDisconnect)
	ON_BN_CLICKED(IDC_BT_ZEBRA_STATUS, &CZLabelPreviewSaveDlg::OnBnClickedBtZebraStatus)
	ON_BN_CLICKED(IDC_BT_ZEBRA_STATUS_STOP, &CZLabelPreviewSaveDlg::OnBnClickedBtZebraStatusStop)
	ON_BN_CLICKED(IDC_BT_EMERGENCY, &CZLabelPreviewSaveDlg::OnBnClickedBtEmergency)
	ON_BN_CLICKED(IDC_BT_CONFIG, &CZLabelPreviewSaveDlg::OnBnClickedBtConfig)
	ON_BN_CLICKED(IDC_BT_TIMESYNC, &CZLabelPreviewSaveDlg::OnBnClickedBtTimesync)
	ON_BN_CLICKED(IDC_BT_REBOOT_ZEBRA, &CZLabelPreviewSaveDlg::OnBnClickedBtRebootZebra)
	ON_BN_CLICKED(IDC_BT_AIM, &CZLabelPreviewSaveDlg::OnBnClickedBtAim)
	ON_WM_NCDESTROY()
END_MESSAGE_MAP()

BEGIN_EVENTSINK_MAP(CZLabelPreviewSaveDlg, CDialogEx)
	ON_EVENT(CZLabelPreviewSaveDlg, IDC_EXPLORER, 104, CZLabelPreviewSaveDlg::DownloadCompleteExplorer, VTS_NONE)
	ON_EVENT(CZLabelPreviewSaveDlg, IDC_EXPLORER, 252, CZLabelPreviewSaveDlg::NavigateComplete2Explorer, VTS_DISPATCH VTS_PVARIANT)
	ON_EVENT(CZLabelPreviewSaveDlg, IDC_EXPLORER, 108, CZLabelPreviewSaveDlg::ProgressChangeExplorer, VTS_I4 VTS_I4)
	ON_EVENT(CZLabelPreviewSaveDlg, IDC_EXPLORER, 113, CZLabelPreviewSaveDlg::TitleChangeExplorer, VTS_BSTR)
	ON_EVENT(CZLabelPreviewSaveDlg, IDC_EXPLORER, 102, CZLabelPreviewSaveDlg::StatusTextChangeExplorer, VTS_BSTR)
END_EVENTSINK_MAP()


// CZLabelPreviewSaveDlg 메시지 처리기

BOOL CZLabelPreviewSaveDlg::OnInitDialog()
{
	CDialogEx::OnInitDialog();

	// 시스템 메뉴에 "정보..." 메뉴 항목을 추가합니다.

	// IDM_ABOUTBOX는 시스템 명령 범위에 있어야 합니다.
	ASSERT((IDM_ABOUTBOX & 0xFFF0) == IDM_ABOUTBOX);
	ASSERT(IDM_ABOUTBOX < 0xF000);

	CMenu* pSysMenu = GetSystemMenu(FALSE);
	if (pSysMenu != NULL)
	{
		BOOL bNameValid;
		CString strAboutMenu;
		bNameValid = strAboutMenu.LoadString(IDS_ABOUTBOX);
		ASSERT(bNameValid);
		if (!strAboutMenu.IsEmpty())
		{
			pSysMenu->AppendMenu(MF_SEPARATOR);
			pSysMenu->AppendMenu(MF_STRING, IDM_ABOUTBOX, strAboutMenu);
		}
	}

	// 이 대화 상자의 아이콘을 설정합니다. 응용 프로그램의 주 창이 대화 상자가 아닐 경우에는
	//  프레임워크가 이 작업을 자동으로 수행합니다.
	SetIcon(m_hIcon, TRUE);			// 큰 아이콘을 설정합니다.
	SetIcon(m_hIcon, FALSE);		// 작은 아이콘을 설정합니다.

	// TODO: 여기에 추가 초기화 작업을 추가합니다.

	//중복실행 방지 - 2016-10-11
	HANDLE hEvent;
    hEvent = CreateEvent(NULL, FALSE, TRUE, AfxGetAppName());
    if ( GetLastError() == ERROR_ALREADY_EXISTS)
    {
		//2017-01-31 변경
		//PostMessage(WM_QUIT);  //프로그램 종료   
		EndDialog(IDOK);
    }
	//

	if(!ReadConfigFile())
	{
		MessageBox(L"ZPL2img.INI 설정파일 오류!",L"Error",MB_OK|MB_ICONERROR);
		//2017-01-31 변경
		//PostMessage(WM_QUIT);  //프로그램 종료   
		EndDialog(IDOK);
	}

	//StartMonitoringZEBRA(); //???? 중복

	MoveWindow(0,0,1280,1024);

	SetDlgItemText(IDC_DMS_IPADDR,m_strDMS_IP);
	SetDlgItemText(IDC_EDIT_DMS_PORT,m_strDMS_Port);

	SetDlgItemInt(IDC_EDIT_IMG_LIMIT,m_nImgInMemoryLimit); //2017-07-31 복구
	SetDlgItemText(IDC_EDIT_IMG_NO,m_strNumOfImgInMemory); //2017-01-20

	m_ctlCbZpl.SetCurSel(0);

	GetDlgItem(IDC_EXPLORER)->GetWindowRect(&m_Rect);

	CString str;
	for(int i = 1; i < 53; i++)
	{
		str.Format(L"LABEL%02d",i);
		((CComboBox*)GetDlgItem(IDC_CB_ZPL))->AddString(str);
	}

	GoHome(); 
	
	//2017-07-06
	CString strLog = _T("ZPL2img Start");
	GetLog()->Debug(strLog.GetBuffer());

	//2017-01-16
	//SetTimer(IDD + 1, 1000 * 5, NULL); //DMS 접속
	int nElapse = m_nDMS_ConnectTerm * 1000;
	//SetTimer(IDD+1,nElapse,NULL); //
	SetTimer(TIMER_DMS_CONNECT,nElapse,NULL); //2017-07-06
	//

	SetFocusOnWebCtrl();

	RecordZebraRecovery(TRUE); //TRUE: 복구완료(제브라재부팅,앱실행), FALSE: 복구진행중
	RecordZebraWaiting(FALSE); //2017-07-24 Zebra 연결불안정 대기 해제
	StartMonitoringZEBRA();

	//2017-06-08
	GetDlgItem(IDC_BT_AIM)->MoveWindow(m_nRectX,m_nRectY,m_nRectCX,m_nRectCY);
	
	nElapse = m_nRetryCheckTerm * 1000;
	SetTimer(TIMER_RETRY_CHECK,nElapse,NULL); //2017-07-20

	return TRUE;  // 포커스를 컨트롤에 설정하지 않으면 TRUE를 반환합니다.
}

void CZLabelPreviewSaveDlg::OnSysCommand(UINT nID, LPARAM lParam)
{
	if ((nID & 0xFFF0) == IDM_ABOUTBOX)
	{
		CAboutDlg dlgAbout;
		dlgAbout.DoModal();
	}
	else
	{
		CDialogEx::OnSysCommand(nID, lParam);
	}
}

// 대화 상자에 최소화 단추를 추가할 경우 아이콘을 그리려면
//  아래 코드가 필요합니다. 문서/뷰 모델을 사용하는 MFC 응용 프로그램의 경우에는
//  프레임워크에서 이 작업을 자동으로 수행합니다.

void CZLabelPreviewSaveDlg::OnPaint()
{
	if (IsIconic())
	{
		CPaintDC dc(this); // 그리기를 위한 디바이스 컨텍스트입니다.

		SendMessage(WM_ICONERASEBKGND, reinterpret_cast<WPARAM>(dc.GetSafeHdc()), 0);

		// 클라이언트 사각형에서 아이콘을 가운데에 맞춥니다.
		int cxIcon = GetSystemMetrics(SM_CXICON);
		int cyIcon = GetSystemMetrics(SM_CYICON);
		CRect rect;
		GetClientRect(&rect);
		int x = (rect.Width() - cxIcon + 1) / 2;
		int y = (rect.Height() - cyIcon + 1) / 2;

		// 아이콘을 그립니다.
		dc.DrawIcon(x, y, m_hIcon);
	}
	else
	{
		CDialogEx::OnPaint();
	}
}

// 사용자가 최소화된 창을 끄는 동안에 커서가 표시되도록 시스템에서
//  이 함수를 호출합니다.
HCURSOR CZLabelPreviewSaveDlg::OnQueryDragIcon()
{
	return static_cast<HCURSOR>(m_hIcon);
}

void CZLabelPreviewSaveDlg::SetClipboardText(CString &szData)
{
    HGLOBAL h;
    LPTSTR arr;

    size_t bytes = (szData.GetLength()+1)*sizeof(TCHAR);
    h=GlobalAlloc(GMEM_MOVEABLE, bytes);
    arr=(LPTSTR)GlobalLock(h);
    ZeroMemory(arr,bytes);
    _tcscpy_s(arr, szData.GetLength()+1, szData);
    szData.ReleaseBuffer();
    GlobalUnlock(h);

    ::OpenClipboard (NULL);
    EmptyClipboard();
    SetClipboardData(CF_UNICODETEXT, h);
    CloseClipboard();
}

void CZLabelPreviewSaveDlg::GetClipboardText()
{
	if (OpenClipboard()) 
	{
		if (::IsClipboardFormatAvailable(CF_TEXT) || ::IsClipboardFormatAvailable(CF_OEMTEXT))
		{
			HANDLE hClipboardData = GetClipboardData(CF_UNICODETEXT);
			GlobalUnlock(hClipboardData);
		}
		else
		{ 
			CString str =L"There is no text (ANSI) data on the Clipboard.";
			GetLog()->Debug(str.GetBuffer(0));
		}
		CloseClipboard();
	}
}

void CZLabelPreviewSaveDlg::TabKey(CWnd* pWnd)
{
	pWnd->SetFocus();
	keybd_event(VK_TAB,0,0,0);        
	keybd_event(VK_TAB,0,KEYEVENTF_KEYUP,0);
}

void CZLabelPreviewSaveDlg::CtrlV(CWnd* pWnd)
{
	pWnd->SetFocus();
	keybd_event(VK_CONTROL, MapVirtualKey(VK_CONTROL, 0), 0, 0);  // Ctrl
	keybd_event(0x56,MapVirtualKey(0x56,0),0, 0); // V
	keybd_event(0x56,MapVirtualKey(0x56,0),KEYEVENTF_KEYUP,0);  
	keybd_event(VK_CONTROL, MapVirtualKey(VK_CONTROL,0),KEYEVENTF_KEYUP,0); 
}

void CZLabelPreviewSaveDlg::EnterKey(CWnd* pWnd)
{
	pWnd->SetFocus();
	keybd_event(VK_RETURN,0,0,0);       
	keybd_event(VK_RETURN,0,KEYEVENTF_KEYUP,0);
}

void CZLabelPreviewSaveDlg::OnBnClickedBtExec()
{
	// TODO: 여기에 컨트롤 알림 처리기 코드를 추가합니다.

	if(m_strZPL.GetLength() <= 0)
		return;

	ProcessStart();
}

//2017-01-08
BOOL CZLabelPreviewSaveDlg::CheckZPL(CString strZPL)
{
	int nIdx = -1;
	int nIdx2 = -1;

	nIdx = strZPL.Find(L"^XA");
	nIdx2 = strZPL.Find(L"^XZ");

	if(nIdx < 0 || nIdx2 < 0)
	{
		return FALSE;
	}
	else
		return TRUE;
}

HRESULT CZLabelPreviewSaveDlg::ZPL2Img()
{
	if(m_strZPL.GetLength() <= 0)
	{
		CString strLog = L"[ERROR] m_strZPL.GetLength() <= 0"; //2016-11-01 
		GetLog()->Debug(strLog.GetBuffer());

		Retry(); //2017-01-18

		return S_FALSE;
	}

	if(CheckZPL(m_strZPL) == FALSE) //2017-01-08
	{
		CString strLog;
		strLog.Format(L"[ERROR] CheckZPL(...) == FALSE\r\n[m_strZPL]%s",m_strZPL); 
		GetLog()->Debug(strLog.GetBuffer());
		
		Retry(); //2017-01-18

		return S_FALSE;
	}

	CString strLog;
	SetClipboardText(m_strZPL);

	SetFocusOnWebCtrl(); //2016-10-26

	GetClipboardText();

	SetForegroundWindow();
	TabKey(GetDlgItem(IDC_EXPLORER));

	SetForegroundWindow();
	TabKey(GetDlgItem(IDC_EXPLORER));
	CtrlV(GetDlgItem(IDC_EXPLORER));
	
	SetForegroundWindow();
	TabKey(GetDlgItem(IDC_EXPLORER));

	SetForegroundWindow();
	EnterKey(GetDlgItem(IDC_EXPLORER));

	return S_OK;
}

HRESULT CZLabelPreviewSaveDlg::ZPL2ImgEx() //2017-06-14 v2.0 TAB key -> SetCursorPos 
{
	if(m_strZPL.GetLength() <= 0)
	{
		CString strLog = L"[ERROR] m_strZPL.GetLength() <= 0"; 
		GetLog()->Debug(strLog.GetBuffer());
		Retry(); //2017-01-18
		return S_FALSE;
	}

	if(CheckZPL(m_strZPL) == FALSE) //2017-01-08
	{
		CString strLog;
		strLog.Format(L"[ERROR] CheckZPL(...) == FALSE\r\n[m_strZPL]%s",m_strZPL); 
		GetLog()->Debug(strLog.GetBuffer());
		Retry(); //2017-01-18
		return S_FALSE;
	}

	CString strLog;
	SetClipboardText(m_strZPL);

	SetFocusOnWebCtrl(); 
	GetClipboardText();

//2017-06-14 v2.0 TAB key -> SetCursorPos 
//////////////////////////////////////////////////////////////////////////////////////////////
	CRect r;
	int x,y;
	CPoint point;

	GetDlgItem(IDC_EXPLORER)->GetWindowRect(r);
	x = (r.left + r.right) / 2;
	y = (r.top + r.bottom) / 2;
	SetCursorPos(x, y);

	GetCursorPos(&point);
	if(r.PtInRect(point))
	{
		ClickMouse(x, y, 1); 
		CtrlV(GetDlgItem(IDC_EXPLORER));
	}
	else
	{
		strLog.Format(L"[ERROR]r.PtInRect(point) - <IDC_EXPLORER> r.left:%d r.right:%d x:%d y:%d GetCusorPos()-> %d,%d",
												 r.left, r.right, x, y ,point.x, point.y);
		GetLog()->Debug(strLog.GetBuffer());
		Retry();
		return S_FALSE;
	}
	
	GetDlgItem(IDC_BT_AIM)->GetWindowRect(r);

	x = (r.left + r.right) / 2;
	y = (r.top + r.bottom) / 2;
	SetCursorPos(x, y);

	GetCursorPos(&point);

	if(r.PtInRect(point))
	{
		GetDlgItem(IDC_BT_AIM)->ShowWindow(SW_HIDE);
		ClickMouse(x, y, 1); 
	}
	else
	{
		strLog.Format(L"[ERROR]r.PtInRect(point) - <IDC_BT_AIM> r.left:%d r.right:%d x:%d y:%d GetCusorPos()-> %d,%d",
												 r.left, r.right, x, y ,point.x, point.y);
		GetLog()->Debug(strLog.GetBuffer());
		Retry(); 
		return S_FALSE;
	}
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////	
	return S_OK;
}

void CZLabelPreviewSaveDlg::PrepareNewZPL()
{
	//SetDlgItemText(IDC_EDIT_ZPL,L"");
	m_strZPL = L"";
	UpdateData(FALSE); //2017-01-09
	GoHome();
}

void CZLabelPreviewSaveDlg::OnBnClickedBtNew()
{
	PrepareNewZPL();
	SetFocusOnWebCtrl();
}

void CZLabelPreviewSaveDlg::DownloadCompleteExplorer()
{
	// TODO: 여기에 메시지 처리기 코드를 추가합니다.
	;
}

//#define HOME_URL L"http://192.168.1.120/zpl%20%20%20%20%20%20%20%20%20%20%20FA8C470Dost?dev=R&oname=UNKNOWN&otype=ZPL&pw=&data="
//#define END_URL  L"http://192.168.1.120/zpl"

void CZLabelPreviewSaveDlg::NavigateComplete2Explorer(LPDISPATCH pDisp, VARIANT* URL)
{
	// TODO: 여기에 메시지 처리기 코드를 추가합니다.
	
	CString strCurUrl = m_IExplorer.get_LocationURL();
	
	SetWindowText(strCurUrl);

	if(strCurUrl.Left(30) == m_strHomeUrl)
	{
		m_nStatus = 0;
	}
	else if(strCurUrl == m_strEndUrl) 
	{
		m_nStatus = 1;

		//2017-01-16
		int nElapse = m_nSaveImageTerm * 1000;
		//SetTimer(IDD,nElapse,NULL); //SaveImage...
		SetTimer(TIMER_SAVE_IMAGE,nElapse,NULL); //2017-07-06
	}
	else if(strCurUrl.Left(30) != m_strHomeUrl && strCurUrl != m_strEndUrl)
	{
		m_nStatus = -1;
	}
}


CString CZLabelPreviewSaveDlg::GetCurTime()
{
	CTime t = CTime::GetCurrentTime();
	CString strTime = L"";
	strTime.Format(L"%04d%02d%02d%02d%02d%02d",  t.GetYear(), t.GetMonth(), t.GetDay(), t.GetHour(),  t.GetMinute(), t.GetSecond());  
	CString strEAPformat = strTime.Mid(2); //YYMMDDHHSS - SKhynix Module Inline (2014~) - EAP 최용진(?) 과장 때 저렇게 그냥 맞춰줌.
	return strEAPformat;
}

void CZLabelPreviewSaveDlg::OnCbnCloseupCbZpl()
{
	// TODO: 여기에 컨트롤 알림 처리기 코드를 추가합니다.
	int nSelZPL = m_ctlCbZpl.GetCurSel();

	m_strZPL = TEST_ZPL[nSelZPL];
	//m_strZPL.Replace(L"\\",L"\\\\");

	UpdateData(FALSE);
}


void CZLabelPreviewSaveDlg::OnBnClickedBtExit()
{
	// TODO: 여기에 컨트롤 알림 처리기 코드를 추가합니다.
	CString strLog;
	strLog.Format(L"[Process Exit] - OnBnClickedBtExit() [Num Of Image In Memory %s]",m_strNumOfImgInMemory);
	GetLog()->Debug(strLog.GetBuffer());
	//2017-01-31 변경
	//PostMessage(WM_QUIT);  //프로그램 종료   
	EndDialog(IDOK);
}

CString CZLabelPreviewSaveDlg::GetExecuteDirectory()
{
	CString strFolderPath;

	// 현재 프로그램의 실행 파일이 있는 폴더명을 추출함
	::GetModuleFileName(NULL, strFolderPath.GetBuffer(MAX_PATH), MAX_PATH);
	strFolderPath.ReleaseBuffer();
	if (strFolderPath.Find('\\') != -1)
	{
		for (int i = strFolderPath.GetLength() - 1; i >= 0; i--) 
		{
			TCHAR ch = strFolderPath[i];
			strFolderPath.Delete(i);
			if (ch == '\\') break; 
		}
	}
	return strFolderPath;
}

BOOL CZLabelPreviewSaveDlg::ReadConfigFile() // \\ZPL2img.INI
{
	TCHAR szCurrentPath[1024], szValue[0xFF];
	GetCurrentDirectory(1024, szCurrentPath);
	CString strPath = szCurrentPath;
	CString strExePath = GetExecuteDirectory();
	strPath.Format(L"%s\\ZPL2img.ini", strExePath);

	if(!PathFileExists(strPath)) 
	{
		MessageBox(L"ZPL2img.INI 파일이 존재하지 않습니다.", L"Error", MB_ICONERROR);
		return FALSE;
	}

	ZeroMemory(szValue, 0xFF);
	if (GetPrivateProfileString(L"ZEBRA", L"ZEBRA_IP", L"", szValue, sizeof(szValue), strPath))
		m_strZEBRA_IP = szValue;

	ZeroMemory(szValue, 0xFF); 
	if (GetPrivateProfileString(L"ZEBRA", L"ZEBRA_PORT", L"", szValue, sizeof(szValue), strPath)) // 2016-10-21
		m_strZEBRA_Port = szValue;

	ZeroMemory(szValue, 0xFF);
	if (GetPrivateProfileString(L"ZEBRA", L"ZEBRA_CHECK_TERM", L"", szValue, sizeof(szValue), strPath))
		m_nZebraCheckTerm = _wtoi(szValue);

	//2017-01-16
	ZeroMemory(szValue, 0xFF);
	if (GetPrivateProfileString(L"ZEBRA", L"SAVE_IMAGE_TERM", L"", szValue, sizeof(szValue), strPath))
		m_nSaveImageTerm = _wtoi(szValue); 
	ZeroMemory(szValue, 0xFF);
	if (GetPrivateProfileString(L"ZEBRA", L"IMG_LIMIT", L"", szValue, sizeof(szValue), strPath))
		m_nImgInMemoryLimit = _wtoi(szValue);
	//2017-01-18
	ZeroMemory(szValue, 0xFF);
	if (GetPrivateProfileString(L"ZEBRA", L"TIMEOUT", L"", szValue, sizeof(szValue), strPath))
		m_nTimeOut = _wtoi(szValue); 
	//2017-01-25
	ZeroMemory(szValue, 0xFF);
	if (GetPrivateProfileString(L"ZEBRA", L"MAX_IMG_COUNT", L"", szValue, sizeof(szValue), strPath))
		m_nMaxImgCnt = _wtoi(szValue); 
	//2017-06-09
	ZeroMemory(szValue, 0xFF);
	if (GetPrivateProfileString(L"ZEBRA", L"RECT_X", L"", szValue, sizeof(szValue), strPath))
		m_nRectX = _wtoi(szValue); 
	ZeroMemory(szValue, 0xFF);
	if (GetPrivateProfileString(L"ZEBRA", L"RECT_Y", L"", szValue, sizeof(szValue), strPath))
		m_nRectY = _wtoi(szValue); 
	ZeroMemory(szValue, 0xFF);
	if (GetPrivateProfileString(L"ZEBRA", L"RECT_CX", L"", szValue, sizeof(szValue), strPath))
		m_nRectCX = _wtoi(szValue); 
	ZeroMemory(szValue, 0xFF);
	if (GetPrivateProfileString(L"ZEBRA", L"RECT_CY", L"", szValue, sizeof(szValue), strPath))
		m_nRectCY = _wtoi(szValue); 
	//2017-07-19
	ZeroMemory(szValue, 0xFF);
	if (GetPrivateProfileString(L"ZEBRA", L"ZPL_TO_DO", L"", szValue, sizeof(szValue), strPath))
		m_nZplToDo = _wtoi(szValue); 
	//2017-07-20
	ZeroMemory(szValue, 0xFF);
	if (GetPrivateProfileString(L"ZEBRA", L"RETRY_CHECK_TERM", L"", szValue, sizeof(szValue), strPath))
		m_nRetryCheckTerm = _wtoi(szValue);
	//
	ZeroMemory(szValue, 0xFF);
	if (GetPrivateProfileString(L"DMS", L"DMS_IP", L"", szValue, sizeof(szValue), strPath))
		m_strDMS_IP = szValue;

	ZeroMemory(szValue, 0xFF);
	if (GetPrivateProfileString(L"DMS", L"DMS_PORT", L"", szValue, sizeof(szValue), strPath))
		m_strDMS_Port = szValue;
	
	//2017-01-16
	ZeroMemory(szValue, 0xFF);
	if (GetPrivateProfileString(L"DMS", L"DMS_CONNECT_TERM", L"", szValue, sizeof(szValue), strPath))
		m_nDMS_ConnectTerm = _wtoi(szValue);

	return TRUE;
}

// http
void CZLabelPreviewSaveDlg::AddLogEvent(CString str)
{
	m_ctlListEvent.AddString(str);

	int nCnt = m_ctlListEvent.GetCount();

	while(nCnt > 2000)
	{  
		m_ctlListEvent.DeleteString(0);
		break;
	}	  

	m_ctlListEvent.SetCurSel(nCnt - 1);
}
//
void CZLabelPreviewSaveDlg::OnBnClickedBtEventClear()
{
	// TODO: 여기에 컨트롤 알림 처리기 코드를 추가합니다.
	for (int i = 0; i < m_ctlListEvent.GetCount(); i++)
	{
	   m_ctlListEvent.DeleteString(i);
	}
	SetFocusOnWebCtrl();	
}

void CZLabelPreviewSaveDlg::GoHome() // http
{
	CString strIP = L"";

	strIP = m_strZEBRA_IP;

	SetDlgItemText(IDC_ZEBRA_IPADDR, strIP );

	m_strHomeUrl.Format(L"http://%s/printer/zpl%20post?dev=R&oname=UNKNOWN&otype=ZPL&pw=&data=",strIP); //2015-12-02 external print server
	m_strEndUrl.Format(_T("http://%s"),strIP);
	m_strEndUrl += _T("/printer/zpl"); //2015-12-02 external print server

	m_IExplorer.Navigate(m_strHomeUrl,NULL,NULL,NULL,NULL);
	GetDlgItem(IDC_BT_AIM)->ShowWindow(SW_SHOW); //2017-06-14
}

void CZLabelPreviewSaveDlg::ProcessStart()
{
	m_bInImgProcess = TRUE; //2017-07-19

	m_strPrevZPL = m_strZPL;

	//m_strZPL.Replace(L"\\",L"\\\\"); - 2017-01-16 막음. DMS에서 ^FX-주석-제거
	UpdateData(FALSE); //

	//HRESULT hResult = ZPL2Img();
	HRESULT hResult = ZPL2ImgEx();

	if(hResult == S_OK)
	{
		//2017-01-09 - 미생성시 재요청
		int nElapse = m_nTimeOut * 1000;
		//SetTimer(IDD+1111,nElapse,NULL);
		SetTimer(TIMER_TIMEOUT,nElapse,NULL); //2017-07-06
	}
}

//Preview Label - 웹 브라우저 컨트롤 event / 2015-12-10
/*
StatusTextChangeExplorer(LPCTSTR Text) /완료/
ProgressChangeExplorer(long Progress, long ProgressMax) - 10000 / 10000
ProgressChangeExplorer(long Progress, long ProgressMax) - -1 / 10000
DownloadCompleteExplorer
ProgressChangeExplorer(long Progress, long ProgressMax) - 10000 / 10000
CommandStateChangeExplorer(long Command, BOOL Enable) - -1 / FALSE
ProgressChangeExplorer(long Progress, long ProgressMax) - 0 / 0
StatusTextChangeExplorer(LPCTSTR Text) /완료/
StatusTextChangeExplorer(LPCTSTR Text) /완료/
StatusTextChangeExplorer(LPCTSTR Text) /완료/
StatusTextChangeExplorer(LPCTSTR Text) /완료/
StatusTextChangeExplorer(LPCTSTR Text) /완료/
StatusTextChangeExplorer(LPCTSTR Text) /완료/
StatusTextChangeExplorer(LPCTSTR Text) /완료/
StatusTextChangeExplorer(LPCTSTR Text) /완료/
StatusTextChangeExplorer(LPCTSTR Text) /완료/
StatusTextChangeExplorer(LPCTSTR Text) /완료/
StatusTextChangeExplorer(LPCTSTR Text) /완료/
StatusTextChangeExplorer(LPCTSTR Text) /완료/
StatusTextChangeExplorer(LPCTSTR Text) /완료/
StatusTextChangeExplorer(LPCTSTR Text) /완료/
*/


void CZLabelPreviewSaveDlg::TitleChangeExplorer(LPCTSTR Text)
{
	// TODO: 여기에 메시지 처리기 코드를 추가합니다.
	m_strTitle = Text;
	CString strLog;

	//if( m_strTitle.Left(7) != L"http://" && m_strTitle.Right(15) != L"Edit ZPL Script" && m_strTitle.Right(13) != L"Preview Label")
	if( m_strTitle.Left(7) != OK_L7 && m_strTitle.Right(15) != OK_R15 && m_strTitle.Right(13) != OK_R13)
	{
		m_IExplorer.Stop(); //2017-07-06

		m_nStatus = -100; //Page err
		
		//2016-10-21 
		//strLog.Format(L"[ERROR][Process Exit] TitleChangeExplorer - %s [Num Of Image In Memory %s]",Text, m_strNumOfImgInMemory);
		strLog.Format(L"[ERROR] TitleChangeExplorer - %s m_IExplorer.Stop()",Text);
		GetLog()->Debug(strLog.GetBuffer());
		AddLogEvent(Text);
		//
		Initialize(); //2017-07-28 변경 - ZEBRA web server 다운시 그냥 재부팅하기
		
	}
}

void CZLabelPreviewSaveDlg::ProgressChangeExplorer(long Progress, long ProgressMax)
{
	// TODO: 여기에 메시지 처리기 코드를 추가합니다.
	m_nProgress = Progress;
	m_nProgressMax = ProgressMax;

	if(m_nProgress > 0 || m_nProgressMax > 0)
	{
		m_nStatus = -1;
	}
	else if(m_nProgress == 0 && m_nProgressMax == 0)
	{
		if(m_strTitle.Right(15) == OK_R15)
		{
			m_nStatus = 0;
		}
		else if(m_strTitle.Right(13) ==OK_R13)
		{
			m_nStatus = 1;
		}
		else if(m_strTitle.Right(24) == NG_R24)
		{
			;
		}
	}
	else if(Progress == 10000 && ProgressMax == 10000) //2015-12-10
	{
		;
	}
	
}

void CZLabelPreviewSaveDlg::StatusTextChangeExplorer(LPCTSTR Text)
{
	// TODO: 여기에 메시지 처리기 코드를 추가합니다.
	m_strStatusText = Text;
	if(m_strStatusText == ERR04) //L"res://ieframe.dll/background_gradient.jpg 그림 다운로드 중..."
	{
		//2016-10-21 
		CString strLog;
		m_IExplorer.Stop(); //2017-07-06
		//strLog.Format(L"[ERROR][Process Exit]StatusTextChangeExplorer - %s [Num Of Image In Memory %s]"
		//	,m_strStatusText
		//	,m_strNumOfImgInMemory); //2017-01-20
		strLog.Format(L"[ERROR]StatusTextChangeExplorer - %s m_IExplorer.Stop()",m_strStatusText); //2017-07-0
		GetLog()->Debug(strLog.GetBuffer());
		AddLogEvent(Text);
		
		Initialize(); //2017-07-28 변경 - ZEBRA web server 다운시 그냥 재부팅하기
		
		
	}
}

void CZLabelPreviewSaveDlg::OnTimer(UINT_PTR nIDEvent)
{
	//2017-07-06 nIDEvent naming
	//if(nIDEvent == IDD)
	if(nIDEvent == TIMER_SAVE_IMAGE)
	{
		//2015-09-11
		if( m_strTitle.Right(13) != L"Preview Label" || m_nStatus != 1 ) 
		{
			return;
		}
		
		KillTimer(TIMER_SAVE_IMAGE);

		SaveImage();

	}
	//else if(nIDEvent == IDD+1)
	else if(nIDEvent == TIMER_DMS_CONNECT)
	{
		if(m_bDMSconnected == TRUE)
		{
			KillTimer(TIMER_DMS_CONNECT);
		}
		else
		{
			Connect2DMS(m_strDMS_IP,_wtoi(m_strDMS_Port));
		}
	}
	//else if(nIDEvent == IDD+1000) //ZEBRA STATUS monitoring
	else if(nIDEvent == TIMER_ZEBRA_STATUS) //ZEBRA STATUS monitoring
	{
		if(m_bPauseMonitoringZEBRA == FALSE)
		{
			SendToZEBRA(L"~HS"); 
		}
	}
	//else if(nIDEvent == IDD+1111) //2017-01-09
	else if(nIDEvent == TIMER_TIMEOUT)
	{
		CString strLog = L"[TIMEOUT]";
		
		if(m_strPrevZPL == m_strZPL)
		{
			GetLog()->Debug(strLog.GetBuffer());
			//Retry(); //2017-01-18
			//SetTimer(IDD+1234,100,NULL); //2017-06-29 변경
			PostQuitMessage(0);//2017-07-11
		}
		else 
		{
			KillTimer(IDD+1111);
		}
	}
	else if(nIDEvent == TIMER_RETRY_CHECK) //2017-07-20
	{
		//if(m_nZplToDo > 0 && m_bInImgProcess == FALSE && m_bDMSconnected == TRUE && m_bZebraConnect == TRUE) //m_nZplToDo - ( 1 or 0 )
		if(m_bInImgProcess == FALSE && m_bDMSconnected == TRUE && m_bZebraConnect == TRUE) //2017-07-28 누락이미지 방지차원 조건 변경. Timer간격도 25sec 늘림.
		{
			SendToDMS(L"RETRY");
			SetFocusOnWebCtrl();
		}
	}

	CDialogEx::OnTimer(nIDEvent);
}

void CZLabelPreviewSaveDlg::SaveImage()
{

	// 현재 다이얼로그 핸들 값
	CWnd *pDesktopWnd = (CZLabelPreviewSaveDlg*)GetForegroundWindow();
	
	HDC hDC = NULL;
	if(!pDesktopWnd)
		return;
	CWindowDC DeskTopDC(pDesktopWnd);

	//<atlimage.h>
	if(!m_Image.Create(m_Rect.right, m_Rect.bottom, 32)) 
		return;
	
	hDC = m_Image.GetDC();     
	BitBlt(hDC, 0, 0, m_Rect.right, m_Rect.bottom, DeskTopDC.m_hDC, 0, 0, SRCCOPY);
	//BitBlt(hDC, 0, 400, m_Rect.right, m_Rect.bottom-400, DeskTopDC.m_hDC, 0, 400, SRCCOPY);

	CString strPath;
	CString strFileName;
	strFileName.Format(L"%s.png",GetCurTime());
	strPath.Format(_T("D:\\Label\\%s.png"),GetCurTime()); 
	//strPath.Format(_T("D:\\Label\\%s.png"), m_strFileName);

	CString strLog,strTemp;
	HRESULT HResult = m_Image.Save(strPath, Gdiplus::ImageFormatPNG);
	strTemp = GetMessageForHResult(HResult); //
	strLog.Format(L"%s %s [m_nProgress = %d]",strTemp,strFileName,m_nProgress);//2017-02-03 m_nProgress 추가
	GetLog()->Debug(strLog.GetBuffer());

	m_Image.ReleaseDC();
	m_Image.Destroy();

	m_nStatus = 3;
	//////////////////////////////////////////////////////

	CString strPacket;
	strPacket.Format(L"01IS%04d|%s|",strFileName.GetLength()+10,strFileName);
	 //2017-07-19
	if(SendToDMS(strPacket) > 0)
	{
		m_nZplToDo = 0;
		m_bInImgProcess = FALSE;
	}
	//

	PrepareNewZPL();
}


// TCP/IP
void CZLabelPreviewSaveDlg::MBCS2Unicode(LPCSTR lpData,LPWSTR ReturnData)
{
	memset(ReturnData,0,(strlen(lpData)/2)+5);
	MultiByteToWideChar(949,0,lpData,-1,ReturnData,strlen(lpData));
	return;
}

void CZLabelPreviewSaveDlg::Unicode2MBCS(LPWSTR lpData,LPSTR lpRtd)
{
	memset(lpRtd,0x00,wcslen(lpData)*2+1);
	WideCharToMultiByte(949,0,lpData,-1,lpRtd,wcslen(lpData)*2,NULL,NULL);
	return;
}

void CZLabelPreviewSaveDlg::OnBnClickedBtConnect()
{
	// TODO: 여기에 컨트롤 알림 처리기 코드를 추가합니다.
	Connect2DMS(m_strDMS_IP,_wtoi(m_strDMS_Port));
	SetFocusOnWebCtrl();
}

void CZLabelPreviewSaveDlg::OnBnClickedBtDisconnect()
{
	// TODO: 여기에 컨트롤 알림 처리기 코드를 추가합니다.
	Disconnect2DMS();
	SetFocusOnWebCtrl();
}

void CZLabelPreviewSaveDlg::DisplayLogSocket(CString str)
{
	m_ctlListSocket.AddString(str);

	int nCnt = m_ctlListSocket.GetCount();

	while(nCnt > 2000)
	{  
		m_ctlListSocket.DeleteString(0);
		break;
	}	  

	m_ctlListSocket.SetCurSel(nCnt - 1);
}

void CZLabelPreviewSaveDlg::Connect2DMS(CString strIP,UINT nPort)
{
	CString strLog;
	m_Socket.ShutDown();
	m_Socket.Close();
	m_Socket.CancelBlockingCall();
	
	m_Socket.Create();
	
	if(m_Socket.Connect(strIP, nPort) == FALSE) //
	{
		m_Socket.ShutDown();
		m_Socket.Close();
		m_Socket.CancelBlockingCall(); //

		strLog = _T("[ERROR] Failed to connect DMS");
		DisplayLogSocket(strLog);
		GetLog()->Debug(strLog.GetBuffer());

		GetDlgItem(IDC_BT_CONNECT)->EnableWindow(TRUE);

		m_bDMSconnected = FALSE;
		GetDlgItem(IDC_BT_EMERGENCY)->EnableWindow(FALSE);
	}
	else
	{
		CString strLog = _T("DMS connected");
		DisplayLogSocket(strLog);
		GetLog()->Debug(strLog.GetBuffer());

		m_bDMSconnected = TRUE;
		GetDlgItem(IDC_BT_CONNECT)->EnableWindow(FALSE);
		GetDlgItem(IDC_BT_EMERGENCY)->EnableWindow(TRUE);

		//2017-01-18
		SendToDMS(L"TIME"); //TIMESYNC
		Retry(); //한번 시도 - 누락이미지 확인
	}
}

void CZLabelPreviewSaveDlg::Disconnect2DMS()
{
	m_Socket.ShutDown();
	m_Socket.Close();
	m_Socket.CancelBlockingCall();

	CString strLog = _T("DMS disconnected.");
	DisplayLogSocket(strLog);
	GetLog()->Debug(strLog.GetBuffer());

	m_bDMSconnected = FALSE;
	GetDlgItem(IDC_BT_CONNECT)->EnableWindow(TRUE);
	GetDlgItem(IDC_BT_EMERGENCY)->EnableWindow(FALSE);
}

//void CZLabelPreviewSaveDlg::SocketSend(CString strSendPacket)
int CZLabelPreviewSaveDlg::SendToDMS(CString strSendPacket)
{
	int nError = -1;
	//2017-01-16
	if(m_bDMSconnected == FALSE)
	{
		PostQuitMessage(0); //2017-07-12 Hot-Fix
		return nError;
	}

	char chSendPacket[1024];
	memset(chSendPacket,0x00,sizeof(chSendPacket));
	
	CString strLog;

	Unicode2MBCS(strSendPacket.GetBuffer(0),chSendPacket);
	nError = m_Socket.Send((LPVOID)chSendPacket,strlen(chSendPacket)+1);

	//if(nError < 0)
	if(nError == SOCKET_ERROR) //2017-02-03
	{
		//strLog.Format(_T("[ERROR] %s - ErrCode: %d"), strSendPacket, nError);
		strLog.Format(_T("[ERROR] %s - ErrCode: %d"), strSendPacket,GetLastError());
		LogSend2DMS(strLog);

		strLog.Format(_T("[SND-DMS][ERROR] %s - ErrCode: %d"), strSendPacket, nError);
		DisplayLogSocket(strLog);
		
		//2015-07-24 재접속
		/*OnBnClickedBtDisconnect();
		OnBnClickedBtConnect();*/
		PostQuitMessage(0); //2017-07-12 Hot-Fix
	}
	else if(nError > 0)
	{
		strLog.Format(_T("%s"), strSendPacket);
		LogSend2DMS(strSendPacket);
		strLog.Format(_T("[SND-DMS] %s"), strSendPacket);
		DisplayLogSocket(strLog);	
	}

	return nError;
}

void CZLabelPreviewSaveDlg::ResetByDMS(CString strZPL)
{
	//2017-01-16 변경 - Emergency
	//CString strLog;
	//strLog.Format(_T("[LAST ZPL BEFORE RESET] %s"),strZPL); //2016-10-17 이미지생성 안되는 ZPL 추적용도
	//GetLog()->Debug(strLog.GetBuffer());	
	//RecordExitTime(); //
	//PostMessage(WM_QUIT);

	CString strLog;
	strLog.Format(L"[ResetByDMS-Emergency][LAST ZPL] %s", strZPL); //2017-01-25
	GetLog()->Debug(strLog.GetBuffer());	

	//PrepareNewZPL(); //2017-01-09
	//Sleep(500);
	//SendToDMS(L"RETRY");
	//SetFocusOnWebCtrl();
	
	//SetTimer(IDD+1234,100,NULL); //2017-06-29 변경
	PostQuitMessage(0);//2017-07-11
}

void CZLabelPreviewSaveDlg::LogRcvDMS(CString str)
{
	CString strLog;
	strLog.Format(_T("[RCV-DMS] %s"),str);
	GetLog()->Debug(strLog.GetBuffer());
}

void CZLabelPreviewSaveDlg::LogSend2DMS(CString str)
{
	CString strLog;
	strLog.Format(_T("[SND-DMS] %s"),str);
	GetLog()->Debug(strLog.GetBuffer());
}

void CZLabelPreviewSaveDlg::RecordZebraRecovery(BOOL bRecoveryEnd) //TRUE: 복구완료(제브라재부팅,앱실행), FALSE: 복구진행중
{
	TCHAR szCurrentPath[1024];
	GetCurrentDirectory(1024, szCurrentPath);
	CString strPath = szCurrentPath;
	CString strExePath = GetExecuteDirectory();
	strPath.Format(L"%s\\AppMonitor.ini", strExePath);
	
	if(!PathFileExists(strPath)) 
	{
		CString strLog = L"[Error] AppMonitor.ini 파일이 존재하지 않습니다.";
		GetLog()->Debug(strLog.GetBuffer());
		return;
	}

	SYSTEMTIME st;
	GetLocalTime(&st);
	CString strTime;
	strTime.Format( _T("%04d-%02d-%02d %02d:%02d:%02d"),
			st.wYear, st.wMonth, st.wDay, st.wHour, st.wMinute, st.wSecond);
	if(bRecoveryEnd == TRUE)
	{
		//WritePrivateProfileString(L"ZEBRA",L"REBOOTING_TIME",strTime,strPath); //2017-06-29 혼선의 여지 있어 막음. 재부팅 아님.
		WritePrivateProfileString(L"ZEBRA",L"IN_REBOOTING",L"0",strPath);
	}
	else
	{
		WritePrivateProfileString(L"ZEBRA",L"IN_REBOOTING",L"1",strPath);
	}
}

void CZLabelPreviewSaveDlg::RecordZebraWaiting(BOOL bWaiting) //TRUE: 대기, FALSE: 대기해제
{
	TCHAR szCurrentPath[1024];
	GetCurrentDirectory(1024, szCurrentPath);
	CString strPath = szCurrentPath;
	CString strExePath = GetExecuteDirectory();
	strPath.Format(L"%s\\AppMonitor.ini", strExePath);
	
	CString strLog;

	if(!PathFileExists(strPath)) 
	{
		strLog = L"[Error] AppMonitor.ini 파일이 존재하지 않습니다.";
		GetLog()->Debug(strLog.GetBuffer());
		return;
	}

	SYSTEMTIME st;
	GetLocalTime(&st);
	CString strTime;
	strTime.Format( _T("%04d-%02d-%02d %02d:%02d:%02d"),
			st.wYear, st.wMonth, st.wDay, st.wHour, st.wMinute, st.wSecond);
	if(bWaiting == TRUE)
	{
		WritePrivateProfileString(L"ZEBRA",L"WAITING",L"1",strPath);
		strLog = L"[RecordZebraWaiting(TRUE)]";
		GetLog()->Debug(strLog.GetBuffer());
	}
	else
	{
		WritePrivateProfileString(L"ZEBRA",L"WAITING",L"0",strPath);
		strLog = L"[RecordZebraWaiting(FALSE)]";
		GetLog()->Debug(strLog.GetBuffer());
	}
}

void CZLabelPreviewSaveDlg::RecordExitTime()
{
	CString strLog;

	//AppMonitor.ini 기록
	TCHAR szCurrentPath[1024];
	GetCurrentDirectory(1024, szCurrentPath);
	CString strPath = szCurrentPath;
	CString strExePath = GetExecuteDirectory();
	strPath.Format(L"%s\\ZPL2img.ini", strExePath);
	
	if(!PathFileExists(strPath)) 
	{
		strLog = L"[Error] ZPL2img.ini 파일이 존재하지 않습니다.";
		GetLog()->Debug(strLog.GetBuffer());
		return;
	}

	SYSTEMTIME st;
	GetLocalTime(&st);
	CString strTime;
	strTime.Format( _T("%04d-%02d-%02d %02d:%02d:%02d"),
			st.wYear, st.wMonth, st.wDay, st.wHour, st.wMinute, st.wSecond);

	WritePrivateProfileString(L"ZEBRA",L"APP_EXIT_TIME",strTime,strPath);

	CString strTemp;
	strTemp.Format(L"%d", m_nZplToDo);
	WritePrivateProfileString(L"ZEBRA",L"ZPL_TO_DO",strTemp,strPath);

//2017-01-25
	//Log 
	strLog.Format(L"[RecordExitTime] %s / ZPL-To-Do (%s)",strTime, strTemp);
	GetLog()->Debug(strLog.GetBuffer());
}

//2017-01-25
void CZLabelPreviewSaveDlg::RecordMaxImgCount(CString strCount)
{
	CString strLog;

	//AppMonitor.ini 기록
	TCHAR szCurrentPath[1024];
	GetCurrentDirectory(1024, szCurrentPath);
	CString strPath = szCurrentPath;
	CString strExePath = GetExecuteDirectory();
	strPath.Format(L"%s\\ZPL2img.ini", strExePath);
	
	if(!PathFileExists(strPath)) 
	{
		strLog = L"[Error] ZPL2img.ini 파일이 존재하지 않습니다.";
		GetLog()->Debug(strLog.GetBuffer());
		return;
	}
	
	WritePrivateProfileString(L"ZEBRA",L"MAX_IMG_COUNT",strCount,strPath);
	strLog.Format(L"[RecordMaxImgCount] %s",strCount);
	GetLog()->Debug(strLog.GetBuffer());
	
}

//2016-10-21 ZEBRA 상태체크용
BOOL CZLabelPreviewSaveDlg::Connect2ZEBRA(CString strZebraIP, UINT nPort) // TCP/IP
{
	CString strLog;
	
	//2017-07-11 
	m_Socket2.ShutDown();
	m_Socket2.Close();
	m_Socket2.CancelBlockingCall();
	
	BOOL bRet = m_Socket2.Create();
	if(!bRet)
	{
		strLog = "[ERROR] - m_Socket2.Create() for ZEBRA connect";
		GetLog()->Debug(strLog.GetBuffer());
		m_bZebraConnect = FALSE; //2017-07-20
		PostQuitMessage(0);//2017-07-11
	}
	//
	if(m_Socket2.Connect(strZebraIP, nPort) == FALSE) //
	{
		m_Socket2.ShutDown();
		m_Socket2.Close();

		//2017-01-24 오류처리추가
		//CString strLog = _T("[ERROR] Connect ZEBRA fail. - ");
		//strLog.Format(L"[ERROR][Process Exit] - Connect ZEBRA fail. [Num Of Image In Memory %s]", m_strNumOfImgInMemory);
		strLog.Format(L"[ERROR] - Connect ZEBRA fail. [Num Of Image In Memory %s]", m_strNumOfImgInMemory); //2017-07-06
		GetLog()->Debug(strLog.GetBuffer());
		DisplayLogSocket(strLog);

		//RecordExitTime();
		//2017-01-31 변경
		//PostMessage(WM_QUIT);  //프로그램 종료   
		//EndDialog(IDOK);
		//SetTimer(IDD+1234,100,NULL); //2017-06-28 변경
		m_bZebraConnect = FALSE; //2017-07-20
		RecordZebraWaiting(TRUE); //2017-07-24 Zebra 연결불안정 대기
		PostQuitMessage(0);  //2017-07-11  
//
		return FALSE;
	}
	else
	{
		/*CString strLog = _T("ZEBRA connected.");
		GetLog()->Debug(strLog.GetBuffer());
		DisplayLogSocket(strLog);*/	

		return TRUE;
	}
}

void CZLabelPreviewSaveDlg::Disconnect2ZEBRA()
{
	m_Socket2.ShutDown();
	m_Socket2.Close();

	//m_Socket2.CancelBlockingCall(); //2017-07-14 주석처리

	/*CString strLog = _T("ZEBRA Disconnected.");
	GetLog()->Debug(strLog.GetBuffer());
	DisplayLogSocket(strLog);*/	
}

int CZLabelPreviewSaveDlg::SocketSend2(CString strSendPacket)
{
	char chSendPacket[1024];
	memset(chSendPacket,0x00,sizeof(chSendPacket));
	
	CString strLog;

	Unicode2MBCS(strSendPacket.GetBuffer(0),chSendPacket);
	int nError = m_Socket2.Send((LPVOID)chSendPacket,strlen(chSendPacket)+1);

	if(nError < 0)
	{
		strLog.Format(_T("[ERROR] %s - ErrCode: %d"), strSendPacket, nError);
		LogSend2ZEBRA(strLog);

		strLog.Format(_T("[SND-ZEBRA][ERROR] %s - ErrCode: %d"), strSendPacket, nError);
		DisplayLogSocket(strLog);
	}
	else
	{
		strLog.Format(_T("%s"), strSendPacket);
		LogSend2ZEBRA(strSendPacket);

		strLog.Format(_T("[SND-ZEBRA] %s"), strSendPacket);
		DisplayLogSocket(strLog);	
	}
	return nError;
}

int CZLabelPreviewSaveDlg::SendToZEBRA(CString strZPL)
{
	int nRet = SOCKET_ERROR;
	CString strLog;
	char chSendPacket[1024*10]; //size 넉넉히...
	memset(chSendPacket,0x00,sizeof(chSendPacket));
	
	Unicode2MBCS(strZPL.GetBuffer(),chSendPacket);

	if( Connect2ZEBRA(m_strZEBRA_IP, _wtoi(m_strZEBRA_Port)))
	{
		nRet = SocketSend2(strZPL);
	}
	else
	{
		nRet = SOCKET_ERROR;
		m_bZebraConnect = FALSE; //2017-07-20
	}

	//Disconnect2ZEBRA(); //2017-07-14 이동 from ParseZEBRAResponse(...)
	if(nRet > 0 )
	{
		m_bZebraConnect = TRUE; //2017-07-20
	}
	return nRet;
}

void CZLabelPreviewSaveDlg::LogRcvZEBRA(CString str)
{
	CString strLog;
	strLog.Format(_T("[RCV-ZEBRA] %s"),str);
	GetLog()->Debug(strLog.GetBuffer());
}

void CZLabelPreviewSaveDlg::LogSend2ZEBRA(CString str)
{
	CString strLog;
	strLog.Format(_T("[SND-ZEBRA] %s"),str);
	GetLog()->Debug(strLog.GetBuffer());
}

void CZLabelPreviewSaveDlg::ParseZEBRAResponse(TCHAR* tch) //2016-10-25 ~HS command response parsing
{
	CString strLog = L"";
	CString strStatus = tch;

	LogRcvZEBRA(strStatus);

	CString strPaperOut,strPauseFlag, strHeadUp, 
			strRibbonOut, strThermalTransMode, strPrintMode,
			strNumOfImgInMemory;
//String 1
	AfxExtractSubString(strPaperOut, strStatus, 1, ','); //(1 = paper out)
	AfxExtractSubString(strPauseFlag, strStatus, 2, ','); //(1 = pause active)
//String 2
	AfxExtractSubString(strHeadUp, strStatus, 13, ','); //(1 = head in up position)
	AfxExtractSubString(strRibbonOut, strStatus, 14, ','); //(1 = ribbon out)
	AfxExtractSubString(strThermalTransMode, strStatus, 15, ','); //(1 = Thermal Transfer Mode selected)
	AfxExtractSubString(strPrintMode, strStatus, 16, ','); //Print Mode 0 = Rewind 1 = Peel-Off 2 = Tear-Off 3 = Cutter 4 = Applicator 5 = Delayed cut 6 = Linerless Peel 7 = Linerless Rewind 8 = Partial Cutter 9 = RFID K = Kiosk S = Stream
	AfxExtractSubString(strNumOfImgInMemory, strStatus, 21, ','); //Number of Graphic Images stored in Memory
	//2017-01-20 ex) [RCV-ZEBRA] ...00000000,1,(0x02)021(0x03)\r\n(0x02)1234(0x03),0
	int nIdx = strNumOfImgInMemory.Find(0x03); //ETX
	//2017-01-31 변동 있을 때만 기록하게 변경. Log 줄임
	if(strPaperOut != L"0" || strPauseFlag != L"0" || m_strNumOfImgInMemory != strNumOfImgInMemory.Left(nIdx) )
	{
		m_strNumOfImgInMemory = strNumOfImgInMemory.Left(nIdx);
		SetDlgItemText(IDC_EDIT_IMG_NO,m_strNumOfImgInMemory);
	
		strLog.Format(L"[~HS]PaperOut:%s/Pause:%s/HeadUp:%s/RibbonOut:%s/ThermalTrans:%s/"
					  L"PrintMode:%s/NumOfImgInMemory:%s", 
					  strPaperOut, strPauseFlag, strHeadUp, strRibbonOut,strThermalTransMode,
					  strPrintMode, m_strNumOfImgInMemory);
		GetLog()->Debug(strLog.GetBuffer());
	}
	//화면표시
	CTime t = CTime::GetCurrentTime();
	CString strTime = L"";
	strTime.Format(L"%04d-%02d-%02d %02d:%02d:%02d",  t.GetYear(), t.GetMonth(), t.GetDay(), t.GetHour(),  t.GetMinute(), t.GetSecond());  

	strLog.Format(L"[%s]\r\n"
				  L"PaperOut:%s/ Pause:%s\r\n"
				  L"HeadUp:%s/ RibbonOut:%s\r\n"
				  L"ThermalTrans:%s/ PrintMode:%s", 
				  strTime,
				  strPaperOut, strPauseFlag, 
				  strHeadUp, strRibbonOut,
				  strThermalTransMode, strPrintMode);
	SetDlgItemText(IDC_EDIT_ZEBRA,strLog);
	//
	//Disconnect2ZEBRA(); 2017-07-14 주석처리 & 이동-> Send2Zebra()

	//int nImgInMemory = _wtoi(strNumOfImgInMemory);
	int nImgInMemory = _wtoi(m_strNumOfImgInMemory); //2017-08-07 변경
	//if(strPaperOut != L"0" || strPauseFlag != L"0" || nImgInMemory > m_nImgInMemoryLimit ) //
	if(strPaperOut != L"0" || strPauseFlag != L"0" ) //2017-01-20 REBOOT 조건 변경
	{
		//2017-01-23 참고 "~JA" command
		//~JA (Cancel All) - All internal buffers are cleared of data. The DATA LED turns off
		//But ZebraNet Print Server 복구는 버벅댐. 기존 방식대로 재부팅으로 처리
		int nRet = SendToDMS(L"REBOOT");
		if(nRet > 0 )
		{
			Disconnect2DMS();
			m_bPauseMonitoringZEBRA = TRUE;

			for (int i=0; i < 5; i++) //2016-11-01  재부팅 확실하게 5번 시도
			{
				nRet = SendToZEBRA(L"~JR"); // ~JR : Power On Reset
		
				if(nRet == 4) //~JR(null)  //2016-11-02
				{
					strLog.Format(L"[REBOOT ZEBRA] PaperOut:%s / Pause:%s / NumOfImgInMemory:%s | SendToZEBRA(~JR) - %d", 
					strPaperOut, strPauseFlag, m_strNumOfImgInMemory, nRet);
					GetLog()->Debug(strLog.GetBuffer());

					RecordZebraRecovery(FALSE); //TRUE: 복구완료(제브라재부팅,앱실행), FALSE: 복구진행중
					//RecordExitTime();
					//2017-01-25
					if(_wtoi(m_strNumOfImgInMemory) > m_nMaxImgCnt)
					{
						RecordMaxImgCount(m_strNumOfImgInMemory);
					}
					//2017-01-31 변경
					//PostMessage(WM_QUIT);  //프로그램 종료   
					//EndDialog(IDOK);
					PostQuitMessage(0);
					break;
				}
				Sleep(50);
			}	
		}
	}
	//2017-07-31 REBOOT 조건 추가. TO-DO 자재없는 조건 하계휴가 후 추가 //2017-08-07 m_bImgBreak == TRUE 추가
	else if(nImgInMemory > m_nImgInMemoryLimit && m_bInImgProcess == FALSE && m_bDMSconnected == TRUE && m_bZebraConnect == TRUE && m_bImgBreak == TRUE) 
	{
		int nRet = SendToDMS(L"REBOOT");
		if(nRet > 0 )
		{
			Disconnect2DMS();
			m_bPauseMonitoringZEBRA = TRUE;

			for (int i=0; i < 5; i++) //2016-11-01  재부팅 확실하게 5번 시도
			{
				nRet = SendToZEBRA(L"~JR"); // ~JR : Power On Reset
		
				if(nRet == 4) //~JR(null)  //2016-11-02
				{
					strLog.Format(L"[REFRESH ZEBRA REBOOT] NumOfImgInMemory:%s ",  //(log구분-상기 조건으로 재부팅은 v2.0이후 없지만...) REFRESH 
					m_strNumOfImgInMemory);
					GetLog()->Debug(strLog.GetBuffer());

					RecordZebraRecovery(FALSE); //TRUE: 복구완료(제브라재부팅,앱실행), FALSE: 복구진행중
					
					PostQuitMessage(0);
					break;
				}
				Sleep(50);
			}	
		}
	}

}

void CZLabelPreviewSaveDlg::StartMonitoringZEBRA()
{
	int nElapse = m_nZebraCheckTerm * 1000;
	//SetTimer(IDD+1000,nElapse,NULL);
	SetTimer(TIMER_ZEBRA_STATUS,nElapse,NULL); //2017-07-06
	GetDlgItem(IDC_BT_ZEBRA_STATUS)->EnableWindow(FALSE);;
}

void CZLabelPreviewSaveDlg::StopMoniteringZEBRA()
{
	KillTimer(IDD+1000);
	GetDlgItem(IDC_BT_ZEBRA_STATUS)->EnableWindow(TRUE);
}

void CZLabelPreviewSaveDlg::OnBnClickedBtZebraStatus()
{
	// TODO: 여기에 컨트롤 알림 처리기 코드를 추가합니다.
	StartMonitoringZEBRA();
	SetFocusOnWebCtrl();
}
void CZLabelPreviewSaveDlg::OnBnClickedBtZebraStatusStop()
{
	// TODO: 여기에 컨트롤 알림 처리기 코드를 추가합니다.
	StopMoniteringZEBRA();
	SetFocusOnWebCtrl();
}

//2016-10-26 prototype code 정리
void CZLabelPreviewSaveDlg::ShowDefaultPage()
{
	CString strUrl;
	strUrl.Format(L"%s\\default.html",GetExecuteDirectory());
	m_IExplorer.Navigate(strUrl,NULL,NULL,NULL,NULL);
}

void CZLabelPreviewSaveDlg::OnBnClickedBtEmergency() // 2016-10-26 
{
	// TODO: 여기에 컨트롤 알림 처리기 코드를 추가합니다.
	//Make It Simple!
	CString strLog;
	strLog = L"OnBnClickedBtEmergency()";
	GetLog()->Debug(strLog.GetBuffer());

	Retry(); //2017-01-18
}

void CZLabelPreviewSaveDlg::SetFocusOnWebCtrl()
{
	// TODO: 여기에 컨트롤 알림 처리기 코드를 추가합니다.
	for(int i = 0; i < 3; i++) {
		SetForegroundWindow(); //2016-10-27 
		GetDlgItem(IDC_EXPLORER)->SetFocus();
		Sleep(10);
	}
}

CString CZLabelPreviewSaveDlg::GetMessageForHResult(HRESULT hr)
{
	_com_error err(hr);
	CString strErrMsg = L"";
	//if(hr == 0x80004005) //0x80004005 - 지정되지 않음
	//{
	//	strErrMsg = L"[SAVE IMAGE] (HRESULT) UNSPECIFIED";
	//}
	//else
	//{
	strErrMsg.Format( L"[SAVE IMAGE] (HRESULT) Error 0x%08x: %s", hr, err.ErrorMessage() );
	//}
	return strErrMsg;
}

void CZLabelPreviewSaveDlg::OnBnClickedBtConfig()
{
	// TODO: 여기에 컨트롤 알림 처리기 코드를 추가합니다.
	int nRet = MessageBox(L"설정파일 변경후, 변경사항 적용을 위해서 프로그램을 종료[EXIT]하세요.\r\n(프로그램 종료시 자동 재실행됩니다.)\r\n진행하시겠습니까?",
		L"설정변경 확인",MB_OKCANCEL|MB_ICONINFORMATION);

	if(nRet == IDOK)
	{
		ShellExecute(NULL,L"open",L"ZPL2img.INI",NULL,NULL,SW_SHOW); //설정파일 열기
		CString strLog = L"설정파일(ZPL2img.INI) 열림.";
		GetLog()->Debug(strLog.GetBuffer());
	}	
}

void CZLabelPreviewSaveDlg::TimeSync(CString str)
{
	CString strDateTime = str;

	SYSTEMTIME st;
	ZeroMemory(&st,sizeof(st));

	st.wYear = _wtoi(strDateTime.Left(4));
	st.wMonth = _wtoi(strDateTime.Mid(4,2));
	st.wDay = _wtoi(strDateTime.Mid(6,2));
	st.wHour = _wtoi(strDateTime.Mid(8,2));
	st.wMinute =_wtoi(strDateTime.Mid(10,2));
	st.wSecond = _wtoi(strDateTime.Mid(12,2));

	SetLocalTime(&st); //MES TimeSync - UAC level= require Administrator

	CString strLog;
	strLog.Format(L"Time Sync with DMS [%s]", strDateTime);
	GetLog()->Debug(strLog.GetBuffer());
	
}

void CZLabelPreviewSaveDlg::OnBnClickedBtTimesync() //2017-01-12 TimeSync with DMS - Make It Simple!
{
	// TODO: 여기에 컨트롤 알림 처리기 코드를 추가합니다.
	SendToDMS(L"TIME");
}

//2017-01-18
void CZLabelPreviewSaveDlg::Retry() 
{
	PrepareNewZPL(); //2017-01-18
	Sleep(50);
	SendToDMS(L"RETRY");
	SetFocusOnWebCtrl();
}
//2017-01-21
void CZLabelPreviewSaveDlg::OnBnClickedBtRebootZebra()
{
	CString strLog = L"";
	int nRet = SendToDMS(L"REBOOT");
	if(nRet > 0 )
	{
		Disconnect2DMS();
		m_bPauseMonitoringZEBRA = TRUE;

		for (int i=0; i < 5; i++) //재부팅 확실하게 5번 시도
		{
			nRet = SendToZEBRA(L"~JR"); // ~JR : Power On Reset
		
			if(nRet == 4) //~JR(null)  //2016-11-02
			{
				strLog.Format(L"[REBOOT ZEBRA] OnBnClickedBtRebootZebra() NumOfImgInMemory:%s | SendToZEBRA(~JR) - %d", 
								 m_strNumOfImgInMemory, nRet);
				GetLog()->Debug(strLog.GetBuffer());

				RecordZebraRecovery(FALSE); //TRUE: 복구완료(제브라재부팅,앱실행), FALSE: 복구진행중
				//RecordExitTime();
				//2017-01-25
				if(_wtoi(m_strNumOfImgInMemory) > m_nMaxImgCnt)
				{
					RecordMaxImgCount(m_strNumOfImgInMemory);
				}
				//2017-01-31 변경
				//PostMessage(WM_QUIT);  //프로그램 종료   
				EndDialog(IDOK);
				break;
			}
			Sleep(50);
		}
	}
}

//2017-01-23 //2017-08-08 수정
void CZLabelPreviewSaveDlg::Initialize()
{
	CString strLog = L"";
	if(m_bDMSconnected == TRUE && m_bZebraConnect == TRUE) //2017-08-08 조건추가
	{
		int nRet = SendToDMS(L"REBOOT");
		Disconnect2DMS();
		m_bPauseMonitoringZEBRA = TRUE;

		for (int i=0; i < 5; i++) //재부팅 확실하게 -_-
		{
			nRet = SendToZEBRA(L"~JR"); // ~JR : Power On Reset
		
			if(nRet == 4) //~JR(null)  //2016-11-02
			{
				strLog.Format(L"[REBOOT ZEBRA] Initialize() NumOfImgInMemory:%s | SendToZEBRA(~JR) - %d", 
									m_strNumOfImgInMemory, nRet);
				GetLog()->Debug(strLog.GetBuffer());

				RecordZebraRecovery(FALSE); //TRUE: 복구완료(제브라재부팅,앱실행), FALSE: 복구진행중
				//2017-01-25
				if(_wtoi(m_strNumOfImgInMemory) > m_nMaxImgCnt)
				{
					RecordMaxImgCount(m_strNumOfImgInMemory);
				}
				PostQuitMessage(0); //2017-07-12
				break;
			}
			Sleep(50);
		}
	}
	else
	{
		PostQuitMessage(0);
	}
}

//2017-06-08
void CZLabelPreviewSaveDlg::ClickMouse(int parm_x, int parm_y, char parm_left_flag) 
{ 
  int x_pos = parm_x*65535/GetSystemMetrics(SM_CXSCREEN); 
  int y_pos = parm_y*65535/GetSystemMetrics(SM_CYSCREEN); 

  ::mouse_event(MOUSEEVENTF_MOVE | MOUSEEVENTF_ABSOLUTE, x_pos, y_pos, 
                                            0, ::GetMessageExtraInfo()); 
  if(parm_left_flag){ 
      ::mouse_event(MOUSEEVENTF_LEFTDOWN | MOUSEEVENTF_ABSOLUTE, 
                              x_pos, y_pos, 0, ::GetMessageExtraInfo()); 
      ::mouse_event(MOUSEEVENTF_LEFTUP | MOUSEEVENTF_ABSOLUTE, 
                              x_pos, y_pos, 0, ::GetMessageExtraInfo()); 
  } else { 
      ::mouse_event(MOUSEEVENTF_RIGHTDOWN | MOUSEEVENTF_ABSOLUTE, 
                              x_pos, y_pos, 0, ::GetMessageExtraInfo()); 
      ::mouse_event(MOUSEEVENTF_RIGHTUP | MOUSEEVENTF_ABSOLUTE, 
                              x_pos, y_pos, 0, ::GetMessageExtraInfo()); 
  } 
} 

void CZLabelPreviewSaveDlg::OnBnClickedBtAim()
{
	AddLogEvent(L"Preview(Aim) Clicked");
}


void CZLabelPreviewSaveDlg::OnNcDestroy()
{
	CDialogEx::OnNcDestroy();

	RecordExitTime();
}
